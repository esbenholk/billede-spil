"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/cloudinary/upload/route";
exports.ids = ["app/api/cloudinary/upload/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("punycode");

/***/ }),

/***/ "querystring":
/*!******************************!*\
  !*** external "querystring" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("querystring");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "worker_threads":
/*!*********************************!*\
  !*** external "worker_threads" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("worker_threads");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "node:fs":
/*!**************************!*\
  !*** external "node:fs" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("node:fs");

/***/ }),

/***/ "node:stream":
/*!******************************!*\
  !*** external "node:stream" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:stream");

/***/ }),

/***/ "node:stream/web":
/*!**********************************!*\
  !*** external "node:stream/web" ***!
  \**********************************/
/***/ ((module) => {

module.exports = require("node:stream/web");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcloudinary%2Fupload%2Froute&page=%2Fapi%2Fcloudinary%2Fupload%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcloudinary%2Fupload%2Froute.ts&appDir=D%3A%5CArtDocumentation%5C2024_ImageEcologySimulation%5CecologyAPI%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CArtDocumentation%5C2024_ImageEcologySimulation%5CecologyAPI&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcloudinary%2Fupload%2Froute&page=%2Fapi%2Fcloudinary%2Fupload%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcloudinary%2Fupload%2Froute.ts&appDir=D%3A%5CArtDocumentation%5C2024_ImageEcologySimulation%5CecologyAPI%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CArtDocumentation%5C2024_ImageEcologySimulation%5CecologyAPI&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var D_ArtDocumentation_2024_ImageEcologySimulation_ecologyAPI_src_app_api_cloudinary_upload_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/cloudinary/upload/route.ts */ \"(rsc)/./src/app/api/cloudinary/upload/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/cloudinary/upload/route\",\n        pathname: \"/api/cloudinary/upload\",\n        filename: \"route\",\n        bundlePath: \"app/api/cloudinary/upload/route\"\n    },\n    resolvedPagePath: \"D:\\\\ArtDocumentation\\\\2024_ImageEcologySimulation\\\\ecologyAPI\\\\src\\\\app\\\\api\\\\cloudinary\\\\upload\\\\route.ts\",\n    nextConfigOutput,\n    userland: D_ArtDocumentation_2024_ImageEcologySimulation_ecologyAPI_src_app_api_cloudinary_upload_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/cloudinary/upload/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZjbG91ZGluYXJ5JTJGdXBsb2FkJTJGcm91dGUmcGFnZT0lMkZhcGklMkZjbG91ZGluYXJ5JTJGdXBsb2FkJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGY2xvdWRpbmFyeSUyRnVwbG9hZCUyRnJvdXRlLnRzJmFwcERpcj1EJTNBJTVDQXJ0RG9jdW1lbnRhdGlvbiU1QzIwMjRfSW1hZ2VFY29sb2d5U2ltdWxhdGlvbiU1Q2Vjb2xvZ3lBUEklNUNzcmMlNUNhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPUQlM0ElNUNBcnREb2N1bWVudGF0aW9uJTVDMjAyNF9JbWFnZUVjb2xvZ3lTaW11bGF0aW9uJTVDZWNvbG9neUFQSSZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDMEQ7QUFDdkk7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUU7QUFDekU7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUN1SDs7QUFFdkgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90cmVuZHMtYWktZ2VuZXJhdG9yLz84ZTc4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIkQ6XFxcXEFydERvY3VtZW50YXRpb25cXFxcMjAyNF9JbWFnZUVjb2xvZ3lTaW11bGF0aW9uXFxcXGVjb2xvZ3lBUElcXFxcc3JjXFxcXGFwcFxcXFxhcGlcXFxcY2xvdWRpbmFyeVxcXFx1cGxvYWRcXFxccm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2Nsb3VkaW5hcnkvdXBsb2FkL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvY2xvdWRpbmFyeS91cGxvYWRcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL2Nsb3VkaW5hcnkvdXBsb2FkL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiRDpcXFxcQXJ0RG9jdW1lbnRhdGlvblxcXFwyMDI0X0ltYWdlRWNvbG9neVNpbXVsYXRpb25cXFxcZWNvbG9neUFQSVxcXFxzcmNcXFxcYXBwXFxcXGFwaVxcXFxjbG91ZGluYXJ5XFxcXHVwbG9hZFxcXFxyb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvY2xvdWRpbmFyeS91cGxvYWQvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcloudinary%2Fupload%2Froute&page=%2Fapi%2Fcloudinary%2Fupload%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcloudinary%2Fupload%2Froute.ts&appDir=D%3A%5CArtDocumentation%5C2024_ImageEcologySimulation%5CecologyAPI%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CArtDocumentation%5C2024_ImageEcologySimulation%5CecologyAPI&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/cloudinary/upload/route.ts":
/*!************************************************!*\
  !*** ./src/app/api/cloudinary/upload/route.ts ***!
  \************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST),\n/* harmony export */   runtime: () => (/* binding */ runtime)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var cloudinary__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! cloudinary */ \"(rsc)/./node_modules/cloudinary/cloudinary.js\");\n/* harmony import */ var cloudinary__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(cloudinary__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var openai__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! openai */ \"(rsc)/./node_modules/openai/index.mjs\");\n\n\n\nconst runtime = \"nodejs\";\nconst openai = new openai__WEBPACK_IMPORTED_MODULE_2__[\"default\"]({\n    apiKey: process.env.OPENAI_API_KEY\n});\ncloudinary__WEBPACK_IMPORTED_MODULE_1__.v2.config({\n    cloud_name: process.env.CLOUDINARY_CLOUD_NAME,\n    api_key: process.env.CLOUDINARY_API_KEY,\n    api_secret: process.env.CLOUDINARY_API_SECRET\n});\nfunction dedupLower(arr) {\n    const seen = new Set();\n    const out = [];\n    for (const t of arr){\n        const k = (t || \"\").trim().toLowerCase();\n        if (!k) continue;\n        if (!seen.has(k)) {\n            seen.add(k);\n            out.push((t || \"\").trim());\n        }\n    }\n    return out;\n}\nasync function POST(request) {\n    try {\n        const { imageUrl, title = \"\", tags = \"\", parentIds, community } = await request.json();\n        // 1) Upload to Cloudinary\n        const result = await cloudinary__WEBPACK_IMPORTED_MODULE_1__.v2.uploader.upload(imageUrl, {\n            folder: \"imageEcology\",\n            context: {\n                alt: title,\n                caption: title,\n                parentIds: parentIds != null ? String(parentIds) : \"\",\n                community: community ?? \"\"\n            },\n            moderation: \"aws_rek:\" + \"explicit_nudity:0.7:\" + \"hate_symbols:0.6:\" + \"suggestive:ignore:\" + \"violence:ignore:\" + \"visually_disturbing:ignore:\" + \"rude_gestures:ignore:\" + \"drugs:ignore:\" + \"tobacco:ignore:\" + \"alcohol:ignore:\" + \"gambling:ignore\"\n        });\n        const moderationArr = result.moderation;\n        const wasRejected = moderationArr?.some((m)=>m.status === \"rejected\" && m.kind.startsWith(\"aws_rek\"));\n        if (wasRejected) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"image does not adhere to our policy\"\n            }, {\n                status: 500\n            });\n        }\n        // 2) Vision -> structured descriptor (schema locked)\n        const schema = {\n            name: \"ImageDescriptor\",\n            strict: true,\n            schema: {\n                type: \"object\",\n                additionalProperties: false,\n                properties: {\n                    title: {\n                        type: \"string\"\n                    },\n                    caption: {\n                        type: \"string\"\n                    },\n                    altText: {\n                        type: \"string\"\n                    },\n                    so_me_type: {\n                        type: \"string\"\n                    },\n                    trend: {\n                        type: \"string\"\n                    },\n                    feeling: {\n                        type: \"string\"\n                    },\n                    // High-value structured fields for remixing\n                    subject: {\n                        type: \"string\"\n                    },\n                    setting: {\n                        type: \"string\"\n                    },\n                    medium: {\n                        type: \"string\"\n                    },\n                    realism: {\n                        type: \"string\"\n                    },\n                    lighting: {\n                        type: \"string\"\n                    },\n                    palette: {\n                        type: \"string\"\n                    },\n                    composition: {\n                        type: \"string\"\n                    },\n                    style: {\n                        type: \"string\"\n                    },\n                    tags: {\n                        type: \"array\",\n                        items: {\n                            type: \"string\"\n                        },\n                        minItems: 0,\n                        maxItems: 16\n                    },\n                    vibe: {\n                        type: \"array\",\n                        items: {\n                            type: \"string\"\n                        },\n                        minItems: 0,\n                        maxItems: 10\n                    },\n                    objects: {\n                        type: \"array\",\n                        items: {\n                            type: \"string\"\n                        },\n                        minItems: 0,\n                        maxItems: 12\n                    },\n                    scenes: {\n                        type: \"array\",\n                        items: {\n                            type: \"string\"\n                        },\n                        minItems: 0,\n                        maxItems: 5\n                    },\n                    people: {\n                        type: \"array\",\n                        items: {\n                            type: \"string\"\n                        },\n                        minItems: 0,\n                        maxItems: 6\n                    },\n                    // Anchors\n                    must_keep: {\n                        type: \"array\",\n                        items: {\n                            type: \"string\"\n                        },\n                        minItems: 3,\n                        maxItems: 10\n                    }\n                },\n                required: [\n                    \"title\",\n                    \"caption\",\n                    \"altText\",\n                    \"so_me_type\",\n                    \"trend\",\n                    \"feeling\",\n                    \"subject\",\n                    \"setting\",\n                    \"medium\",\n                    \"realism\",\n                    \"lighting\",\n                    \"palette\",\n                    \"composition\",\n                    \"style\",\n                    \"tags\",\n                    \"vibe\",\n                    \"objects\",\n                    \"scenes\",\n                    \"people\",\n                    \"must_keep\"\n                ]\n            }\n        };\n        const visionPrompt = `\nYou are describing an image for storage + remixing.\nReturn JSON that matches the provided schema EXACTLY.\n\nRules:\n- \"title\": <= 7 words, aligned with user title \"${title}\" (refine if needed).\n- \"caption\": <= 2 sentences.\n- \"altText\": <= 15 words, neutral literal description.\n- \"subject\": 3-10 words describing the main subject.\n- \"setting\": concise environment description.\n- \"must_keep\": 3-10 concrete anchors that must survive remixing (objects / wardrobe / props / defining features).\n- \"medium\"/\"realism\"/\"lighting\"/\"palette\"/\"composition\": short, remixable phrases.\n- \"style\": a reusable prompt-style string combining medium/realism/lighting/palette/composition succinctly.\n- If no people, \"people\" must be [].\n- If unknown trend, \"trend\" = \"\" (but keep the key).\n`;\n        const completion = await openai.chat.completions.create({\n            model: \"gpt-4o\",\n            temperature: 0.2,\n            max_tokens: 500,\n            response_format: {\n                type: \"json_schema\",\n                json_schema: schema\n            },\n            messages: [\n                {\n                    role: \"user\",\n                    content: [\n                        {\n                            type: \"text\",\n                            text: visionPrompt\n                        },\n                        {\n                            type: \"image_url\",\n                            image_url: {\n                                url: result.secure_url\n                            }\n                        }\n                    ]\n                }\n            ]\n        });\n        const raw = completion.choices[0]?.message?.content ?? \"{}\";\n        const ai = JSON.parse(raw);\n        // 3) Merge tags for Cloudinary\n        const mergedTags = dedupLower([\n            ...ai.tags || [],\n            ...ai.vibe || [],\n            ...ai.objects || [],\n            ...ai.must_keep || [],\n            ...tags ? String(tags).split(\",\") : []\n        ]).slice(0, 40);\n        // 4) Save descriptor back to Cloudinary context\n        await cloudinary__WEBPACK_IMPORTED_MODULE_1__.v2.uploader.explicit(result.public_id, {\n            type: \"upload\",\n            tags: mergedTags.join(\",\"),\n            context: {\n                caption: title,\n                alt: ai.altText,\n                community: community ?? \"\",\n                parentIds: parentIds != null ? String(parentIds) : \"\",\n                // Your original fields\n                ai_title: ai.title,\n                ai_caption: ai.caption,\n                ai_trend: ai.trend,\n                ai_so_me_type: ai.so_me_type,\n                ai_feeling: ai.feeling,\n                ai_style: ai.style,\n                // New structured remix fields\n                ai_subject: ai.subject,\n                ai_setting: ai.setting,\n                ai_medium: ai.medium,\n                ai_realism: ai.realism,\n                ai_lighting: ai.lighting,\n                ai_palette: ai.palette,\n                ai_composition: ai.composition,\n                ai_vibe: (ai.vibe || []).join(\", \"),\n                ai_objects: (ai.objects || []).join(\", \"),\n                ai_scenes: (ai.scenes || []).join(\" | \"),\n                ai_people: (ai.people || []).join(\", \"),\n                ai_must_keep: (ai.must_keep || []).join(\", \")\n            }\n        });\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            url: result.secure_url,\n            publicId: result.public_id,\n            title,\n            ai,\n            tags: mergedTags,\n            parentIds: parentIds ?? null,\n            community: community ?? null\n        });\n    } catch (error) {\n        console.error(\"Upload error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Failed to upload image\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9jbG91ZGluYXJ5L3VwbG9hZC9yb3V0ZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBMkM7QUFDRztBQUNsQjtBQUVyQixNQUFNSSxVQUFVLFNBQVM7QUFFaEMsTUFBTUMsU0FBUyxJQUFJRiw4Q0FBTUEsQ0FBQztJQUFFRyxRQUFRQyxRQUFRQyxHQUFHLENBQUNDLGNBQWM7QUFBQztBQUUvRFAsMENBQVVBLENBQUNRLE1BQU0sQ0FBQztJQUNoQkMsWUFBWUosUUFBUUMsR0FBRyxDQUFDSSxxQkFBcUI7SUFDN0NDLFNBQVNOLFFBQVFDLEdBQUcsQ0FBQ00sa0JBQWtCO0lBQ3ZDQyxZQUFZUixRQUFRQyxHQUFHLENBQUNRLHFCQUFxQjtBQUMvQztBQUVBLFNBQVNDLFdBQVdDLEdBQWE7SUFDL0IsTUFBTUMsT0FBTyxJQUFJQztJQUNqQixNQUFNQyxNQUFnQixFQUFFO0lBQ3hCLEtBQUssTUFBTUMsS0FBS0osSUFBSztRQUNuQixNQUFNSyxJQUFJLENBQUNELEtBQUssRUFBQyxFQUFHRSxJQUFJLEdBQUdDLFdBQVc7UUFDdEMsSUFBSSxDQUFDRixHQUFHO1FBQ1IsSUFBSSxDQUFDSixLQUFLTyxHQUFHLENBQUNILElBQUk7WUFDaEJKLEtBQUtRLEdBQUcsQ0FBQ0o7WUFDVEYsSUFBSU8sSUFBSSxDQUFDLENBQUNOLEtBQUssRUFBQyxFQUFHRSxJQUFJO1FBQ3pCO0lBQ0Y7SUFDQSxPQUFPSDtBQUNUO0FBRU8sZUFBZVEsS0FBS0MsT0FBZ0I7SUFDekMsSUFBSTtRQUNGLE1BQU0sRUFDSkMsUUFBUSxFQUNSQyxRQUFRLEVBQUUsRUFDVkMsT0FBTyxFQUFFLEVBQ1RDLFNBQVMsRUFDVEMsU0FBUyxFQUNWLEdBQUcsTUFBTUwsUUFBUU0sSUFBSTtRQUV0QiwwQkFBMEI7UUFDMUIsTUFBTUMsU0FBUyxNQUFNbkMsMENBQVVBLENBQUNvQyxRQUFRLENBQUNDLE1BQU0sQ0FBQ1IsVUFBVTtZQUN4RFMsUUFBUTtZQUNSQyxTQUFTO2dC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L3NyYy9hcHAvYXBpL2Nsb3VkaW5hcnkvdXBsb2FkL3JvdXRlLnRzP2UxOTIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlc3BvbnNlIH0gZnJvbSBcIm5leHQvc2VydmVyXCI7XG5pbXBvcnQgeyB2MiBhcyBjbG91ZGluYXJ5IH0gZnJvbSBcImNsb3VkaW5hcnlcIjtcbmltcG9ydCBPcGVuQUkgZnJvbSBcIm9wZW5haVwiO1xuXG5leHBvcnQgY29uc3QgcnVudGltZSA9IFwibm9kZWpzXCI7XG5cbmNvbnN0IG9wZW5haSA9IG5ldyBPcGVuQUkoeyBhcGlLZXk6IHByb2Nlc3MuZW52Lk9QRU5BSV9BUElfS0VZIH0pO1xuXG5jbG91ZGluYXJ5LmNvbmZpZyh7XG4gIGNsb3VkX25hbWU6IHByb2Nlc3MuZW52LkNMT1VESU5BUllfQ0xPVURfTkFNRSxcbiAgYXBpX2tleTogcHJvY2Vzcy5lbnYuQ0xPVURJTkFSWV9BUElfS0VZLFxuICBhcGlfc2VjcmV0OiBwcm9jZXNzLmVudi5DTE9VRElOQVJZX0FQSV9TRUNSRVQsXG59KTtcblxuZnVuY3Rpb24gZGVkdXBMb3dlcihhcnI6IHN0cmluZ1tdKSB7XG4gIGNvbnN0IHNlZW4gPSBuZXcgU2V0PHN0cmluZz4oKTtcbiAgY29uc3Qgb3V0OiBzdHJpbmdbXSA9IFtdO1xuICBmb3IgKGNvbnN0IHQgb2YgYXJyKSB7XG4gICAgY29uc3QgayA9ICh0IHx8IFwiXCIpLnRyaW0oKS50b0xvd2VyQ2FzZSgpO1xuICAgIGlmICghaykgY29udGludWU7XG4gICAgaWYgKCFzZWVuLmhhcyhrKSkge1xuICAgICAgc2Vlbi5hZGQoayk7XG4gICAgICBvdXQucHVzaCgodCB8fCBcIlwiKS50cmltKCkpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gb3V0O1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0OiBSZXF1ZXN0KSB7XG4gIHRyeSB7XG4gICAgY29uc3Qge1xuICAgICAgaW1hZ2VVcmwsXG4gICAgICB0aXRsZSA9IFwiXCIsXG4gICAgICB0YWdzID0gXCJcIixcbiAgICAgIHBhcmVudElkcyxcbiAgICAgIGNvbW11bml0eSxcbiAgICB9ID0gYXdhaXQgcmVxdWVzdC5qc29uKCk7XG5cbiAgICAvLyAxKSBVcGxvYWQgdG8gQ2xvdWRpbmFyeVxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNsb3VkaW5hcnkudXBsb2FkZXIudXBsb2FkKGltYWdlVXJsLCB7XG4gICAgICBmb2xkZXI6IFwiaW1hZ2VFY29sb2d5XCIsXG4gICAgICBjb250ZXh0OiB7XG4gICAgICAgIGFsdDogdGl0bGUsXG4gICAgICAgIGNhcHRpb246IHRpdGxlLFxuICAgICAgICBwYXJlbnRJZHM6IHBhcmVudElkcyAhPSBudWxsID8gU3RyaW5nKHBhcmVudElkcykgOiBcIlwiLFxuICAgICAgICBjb21tdW5pdHk6IGNvbW11bml0eSA/PyBcIlwiLFxuICAgICAgfSxcbiAgICAgIG1vZGVyYXRpb246XG4gICAgICAgIFwiYXdzX3JlazpcIiArXG4gICAgICAgIFwiZXhwbGljaXRfbnVkaXR5OjAuNzpcIiArXG4gICAgICAgIFwiaGF0ZV9zeW1ib2xzOjAuNjpcIiArXG4gICAgICAgIFwic3VnZ2VzdGl2ZTppZ25vcmU6XCIgK1xuICAgICAgICBcInZpb2xlbmNlOmlnbm9yZTpcIiArXG4gICAgICAgIFwidmlzdWFsbHlfZGlzdHVyYmluZzppZ25vcmU6XCIgK1xuICAgICAgICBcInJ1ZGVfZ2VzdHVyZXM6aWdub3JlOlwiICtcbiAgICAgICAgXCJkcnVnczppZ25vcmU6XCIgK1xuICAgICAgICBcInRvYmFjY286aWdub3JlOlwiICtcbiAgICAgICAgXCJhbGNvaG9sOmlnbm9yZTpcIiArXG4gICAgICAgIFwiZ2FtYmxpbmc6aWdub3JlXCIsXG4gICAgfSk7XG5cbiAgICBjb25zdCBtb2RlcmF0aW9uQXJyID0gKHJlc3VsdCBhcyBhbnkpLm1vZGVyYXRpb24gYXNcbiAgICAgIHwgeyBzdGF0dXM6IHN0cmluZzsga2luZDogc3RyaW5nOyBpbmZvPzogUmVjb3JkPHN0cmluZywgYW55PiB9W11cbiAgICAgIHwgdW5kZWZpbmVkO1xuXG4gICAgY29uc3Qgd2FzUmVqZWN0ZWQgPSBtb2RlcmF0aW9uQXJyPy5zb21lKFxuICAgICAgKG0pID0+IG0uc3RhdHVzID09PSBcInJlamVjdGVkXCIgJiYgbS5raW5kLnN0YXJ0c1dpdGgoXCJhd3NfcmVrXCIpXG4gICAgKTtcblxuICAgIGlmICh3YXNSZWplY3RlZCkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IGVycm9yOiBcImltYWdlIGRvZXMgbm90IGFkaGVyZSB0byBvdXIgcG9saWN5XCIgfSxcbiAgICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgICApO1xuICAgIH1cblxuICAgIC8vIDIpIFZpc2lvbiAtPiBzdHJ1Y3R1cmVkIGRlc2NyaXB0b3IgKHNjaGVtYSBsb2NrZWQpXG4gICAgY29uc3Qgc2NoZW1hID0ge1xuICAgICAgbmFtZTogXCJJbWFnZURlc2NyaXB0b3JcIixcbiAgICAgIHN0cmljdDogdHJ1ZSxcbiAgICAgIHNjaGVtYToge1xuICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICBhZGRpdGlvbmFsUHJvcGVydGllczogZmFsc2UsXG4gICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICB0aXRsZTogeyB0eXBlOiBcInN0cmluZ1wiIH0sXG4gICAgICAgICAgY2FwdGlvbjogeyB0eXBlOiBcInN0cmluZ1wiIH0sXG4gICAgICAgICAgYWx0VGV4dDogeyB0eXBlOiBcInN0cmluZ1wiIH0sXG4gICAgICAgICAgc29fbWVfdHlwZTogeyB0eXBlOiBcInN0cmluZ1wiIH0sXG4gICAgICAgICAgdHJlbmQ6IHsgdHlwZTogXCJzdHJpbmdcIiB9LFxuICAgICAgICAgIGZlZWxpbmc6IHsgdHlwZTogXCJzdHJpbmdcIiB9LFxuXG4gICAgICAgICAgLy8gSGlnaC12YWx1ZSBzdHJ1Y3R1cmVkIGZpZWxkcyBmb3IgcmVtaXhpbmdcbiAgICAgICAgICBzdWJqZWN0OiB7IHR5cGU6IFwic3RyaW5nXCIgfSxcbiAgICAgICAgICBzZXR0aW5nOiB7IHR5cGU6IFwic3RyaW5nXCIgfSxcbiAgICAgICAgICBtZWRpdW06IHsgdHlwZTogXCJzdHJpbmdcIiB9LCAvLyBwaG90b2dyYXBoIC8gM0QgcmVuZGVyIC8gaWxsdXN0cmF0aW9uIC8gZXRjLlxuICAgICAgICAgIHJlYWxpc206IHsgdHlwZTogXCJzdHJpbmdcIiB9LCAvLyBwaG90b3JlYWxpc3RpYyAvIHN0eWxpemVkIC8gY2FydG9vbiAvIGV0Yy5cbiAgICAgICAgICBsaWdodGluZzogeyB0eXBlOiBcInN0cmluZ1wiIH0sXG4gICAgICAgICAgcGFsZXR0ZTogeyB0eXBlOiBcInN0cmluZ1wiIH0sXG4gICAgICAgICAgY29tcG9zaXRpb246IHsgdHlwZTogXCJzdHJpbmdcIiB9LFxuICAgICAgICAgIHN0eWxlOiB7IHR5cGU6IFwic3RyaW5nXCIgfSwgLy8ga2VlcCB5b3VyIGV4aXN0aW5nIOKAnHN0eWxlIHN0cmluZ+KAnSB0b29cblxuICAgICAgICAgIHRhZ3M6IHtcbiAgICAgICAgICAgIHR5cGU6IFwiYXJyYXlcIixcbiAgICAgICAgICAgIGl0ZW1zOiB7IHR5cGU6IFwic3RyaW5nXCIgfSxcbiAgICAgICAgICAgIG1pbkl0ZW1zOiAwLFxuICAgICAgICAgICAgbWF4SXRlbXM6IDE2LFxuICAgICAgICAgIH0sXG4gICAgICAgICAgdmliZToge1xuICAgICAgICAgICAgdHlwZTogXCJhcnJheVwiLFxuICAgICAgICAgICAgaXRlbXM6IHsgdHlwZTogXCJzdHJpbmdcIiB9LFxuICAgICAgICAgICAgbWluSXRlbXM6IDAsXG4gICAgICAgICAgICBtYXhJdGVtczogMTAsXG4gICAgICAgICAgfSxcbiAgICAgICAgICBvYmplY3RzOiB7XG4gICAgICAgICAgICB0eXBlOiBcImFycmF5XCIsXG4gICAgICAgICAgICBpdGVtczogeyB0eXBlOiBcInN0cmluZ1wiIH0sXG4gICAgICAgICAgICBtaW5JdGVtczogMCxcbiAgICAgICAgICAgIG1heEl0ZW1zOiAxMixcbiAgICAgICAgICB9LFxuICAgICAgICAgIHNjZW5lczoge1xuICAgICAgICAgICAgdHlwZTogXCJhcnJheVwiLFxuICAgICAgICAgICAgaXRlbXM6IHsgdHlwZTogXCJzdHJpbmdcIiB9LFxuICAgICAgICAgICAgbWluSXRlbXM6IDAsXG4gICAgICAgICAgICBtYXhJdGVtczogNSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHBlb3BsZToge1xuICAgICAgICAgICAgdHlwZTogXCJhcnJheVwiLFxuICAgICAgICAgICAgaXRlbXM6IHsgdHlwZTogXCJzdHJpbmdcIiB9LFxuICAgICAgICAgICAgbWluSXRlbXM6IDAsXG4gICAgICAgICAgICBtYXhJdGVtczogNixcbiAgICAgICAgICB9LFxuXG4gICAgICAgICAgLy8gQW5jaG9yc1xuICAgICAgICAgIG11c3Rfa2VlcDoge1xuICAgICAgICAgICAgdHlwZTogXCJhcnJheVwiLFxuICAgICAgICAgICAgaXRlbXM6IHsgdHlwZTogXCJzdHJpbmdcIiB9LFxuICAgICAgICAgICAgbWluSXRlbXM6IDMsXG4gICAgICAgICAgICBtYXhJdGVtczogMTAsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgcmVxdWlyZWQ6IFtcbiAgICAgICAgICBcInRpdGxlXCIsXG4gICAgICAgICAgXCJjYXB0aW9uXCIsXG4gICAgICAgICAgXCJhbHRUZXh0XCIsXG4gICAgICAgICAgXCJzb19tZV90eXBlXCIsXG4gICAgICAgICAgXCJ0cmVuZFwiLFxuICAgICAgICAgIFwiZmVlbGluZ1wiLFxuICAgICAgICAgIFwic3ViamVjdFwiLFxuICAgICAgICAgIFwic2V0dGluZ1wiLFxuICAgICAgICAgIFwibWVkaXVtXCIsXG4gICAgICAgICAgXCJyZWFsaXNtXCIsXG4gICAgICAgICAgXCJsaWdodGluZ1wiLFxuICAgICAgICAgIFwicGFsZXR0ZVwiLFxuICAgICAgICAgIFwiY29tcG9zaXRpb25cIixcbiAgICAgICAgICBcInN0eWxlXCIsXG4gICAgICAgICAgXCJ0YWdzXCIsXG4gICAgICAgICAgXCJ2aWJlXCIsXG4gICAgICAgICAgXCJvYmplY3RzXCIsXG4gICAgICAgICAgXCJzY2VuZXNcIixcbiAgICAgICAgICBcInBlb3BsZVwiLFxuICAgICAgICAgIFwibXVzdF9rZWVwXCIsXG4gICAgICAgIF0sXG4gICAgICB9LFxuICAgIH0gYXMgY29uc3Q7XG5cbiAgICBjb25zdCB2aXNpb25Qcm9tcHQgPSBgXG5Zb3UgYXJlIGRlc2NyaWJpbmcgYW4gaW1hZ2UgZm9yIHN0b3JhZ2UgKyByZW1peGluZy5cblJldHVybiBKU09OIHRoYXQgbWF0Y2hlcyB0aGUgcHJvdmlkZWQgc2NoZW1hIEVYQUNUTFkuXG5cblJ1bGVzOlxuLSBcInRpdGxlXCI6IDw9IDcgd29yZHMsIGFsaWduZWQgd2l0aCB1c2VyIHRpdGxlIFwiJHt0aXRsZX1cIiAocmVmaW5lIGlmIG5lZWRlZCkuXG4tIFwiY2FwdGlvblwiOiA8PSAyIHNlbnRlbmNlcy5cbi0gXCJhbHRUZXh0XCI6IDw9IDE1IHdvcmRzLCBuZXV0cmFsIGxpdGVyYWwgZGVzY3JpcHRpb24uXG4tIFwic3ViamVjdFwiOiAzLTEwIHdvcmRzIGRlc2NyaWJpbmcgdGhlIG1haW4gc3ViamVjdC5cbi0gXCJzZXR0aW5nXCI6IGNvbmNpc2UgZW52aXJvbm1lbnQgZGVzY3JpcHRpb24uXG4tIFwibXVzdF9rZWVwXCI6IDMtMTAgY29uY3JldGUgYW5jaG9ycyB0aGF0IG11c3Qgc3Vydml2ZSByZW1peGluZyAob2JqZWN0cyAvIHdhcmRyb2JlIC8gcHJvcHMgLyBkZWZpbmluZyBmZWF0dXJlcykuXG4tIFwibWVkaXVtXCIvXCJyZWFsaXNtXCIvXCJsaWdodGluZ1wiL1wicGFsZXR0ZVwiL1wiY29tcG9zaXRpb25cIjogc2hvcnQsIHJlbWl4YWJsZSBwaHJhc2VzLlxuLSBcInN0eWxlXCI6IGEgcmV1c2FibGUgcHJvbXB0LXN0eWxlIHN0cmluZyBjb21iaW5pbmcgbWVkaXVtL3JlYWxpc20vbGlnaHRpbmcvcGFsZXR0ZS9jb21wb3NpdGlvbiBzdWNjaW5jdGx5LlxuLSBJZiBubyBwZW9wbGUsIFwicGVvcGxlXCIgbXVzdCBiZSBbXS5cbi0gSWYgdW5rbm93biB0cmVuZCwgXCJ0cmVuZFwiID0gXCJcIiAoYnV0IGtlZXAgdGhlIGtleSkuXG5gO1xuXG4gICAgY29uc3QgY29tcGxldGlvbiA9IGF3YWl0IG9wZW5haS5jaGF0LmNvbXBsZXRpb25zLmNyZWF0ZSh7XG4gICAgICBtb2RlbDogXCJncHQtNG9cIixcbiAgICAgIHRlbXBlcmF0dXJlOiAwLjIsXG4gICAgICBtYXhfdG9rZW5zOiA1MDAsXG4gICAgICByZXNwb25zZV9mb3JtYXQ6IHsgdHlwZTogXCJqc29uX3NjaGVtYVwiLCBqc29uX3NjaGVtYTogc2NoZW1hIH0sXG4gICAgICBtZXNzYWdlczogW1xuICAgICAgICB7XG4gICAgICAgICAgcm9sZTogXCJ1c2VyXCIsXG4gICAgICAgICAgY29udGVudDogW1xuICAgICAgICAgICAgeyB0eXBlOiBcInRleHRcIiwgdGV4dDogdmlzaW9uUHJvbXB0IH0sXG4gICAgICAgICAgICB7IHR5cGU6IFwiaW1hZ2VfdXJsXCIsIGltYWdlX3VybDogeyB1cmw6IHJlc3VsdC5zZWN1cmVfdXJsIH0gfSxcbiAgICAgICAgICBdLFxuICAgICAgICB9LFxuICAgICAgXSxcbiAgICB9KTtcblxuICAgIGNvbnN0IHJhdyA9IGNvbXBsZXRpb24uY2hvaWNlc1swXT8ubWVzc2FnZT8uY29udGVudCA/PyBcInt9XCI7XG4gICAgY29uc3QgYWkgPSBKU09OLnBhcnNlKHJhdykgYXMgYW55O1xuXG4gICAgLy8gMykgTWVyZ2UgdGFncyBmb3IgQ2xvdWRpbmFyeVxuICAgIGNvbnN0IG1lcmdlZFRhZ3MgPSBkZWR1cExvd2VyKFtcbiAgICAgIC4uLihhaS50YWdzIHx8IFtdKSxcbiAgICAgIC4uLihhaS52aWJlIHx8IFtdKSxcbiAgICAgIC4uLihhaS5vYmplY3RzIHx8IFtdKSxcbiAgICAgIC4uLihhaS5tdXN0X2tlZXAgfHwgW10pLFxuICAgICAgLi4uKHRhZ3MgPyBTdHJpbmcodGFncykuc3BsaXQoXCIsXCIpIDogW10pLFxuICAgIF0pLnNsaWNlKDAsIDQwKTtcblxuICAgIC8vIDQpIFNhdmUgZGVzY3JpcHRvciBiYWNrIHRvIENsb3VkaW5hcnkgY29udGV4dFxuICAgIGF3YWl0IGNsb3VkaW5hcnkudXBsb2FkZXIuZXhwbGljaXQocmVzdWx0LnB1YmxpY19pZCwge1xuICAgICAgdHlwZTogXCJ1cGxvYWRcIixcbiAgICAgIHRhZ3M6IG1lcmdlZFRhZ3Muam9pbihcIixcIiksXG4gICAgICBjb250ZXh0OiB7XG4gICAgICAgIGNhcHRpb246IHRpdGxlLFxuICAgICAgICBhbHQ6IGFpLmFsdFRleHQsXG5cbiAgICAgICAgY29tbXVuaXR5OiBjb21tdW5pdHkgPz8gXCJcIixcbiAgICAgICAgcGFyZW50SWRzOiBwYXJlbnRJZHMgIT0gbnVsbCA/IFN0cmluZyhwYXJlbnRJZHMpIDogXCJcIixcblxuICAgICAgICAvLyBZb3VyIG9yaWdpbmFsIGZpZWxkc1xuICAgICAgICBhaV90aXRsZTogYWkudGl0bGUsXG4gICAgICAgIGFpX2NhcHRpb246IGFpLmNhcHRpb24sXG4gICAgICAgIGFpX3RyZW5kOiBhaS50cmVuZCxcbiAgICAgICAgYWlfc29fbWVfdHlwZTogYWkuc29fbWVfdHlwZSxcbiAgICAgICAgYWlfZmVlbGluZzogYWkuZmVlbGluZyxcbiAgICAgICAgYWlfc3R5bGU6IGFpLnN0eWxlLFxuXG4gICAgICAgIC8vIE5ldyBzdHJ1Y3R1cmVkIHJlbWl4IGZpZWxkc1xuICAgICAgICBhaV9zdWJqZWN0OiBhaS5zdWJqZWN0LFxuICAgICAgICBhaV9zZXR0aW5nOiBhaS5zZXR0aW5nLFxuICAgICAgICBhaV9tZWRpdW06IGFpLm1lZGl1bSxcbiAgICAgICAgYWlfcmVhbGlzbTogYWkucmVhbGlzbSxcbiAgICAgICAgYWlfbGlnaHRpbmc6IGFpLmxpZ2h0aW5nLFxuICAgICAgICBhaV9wYWxldHRlOiBhaS5wYWxldHRlLFxuICAgICAgICBhaV9jb21wb3NpdGlvbjogYWkuY29tcG9zaXRpb24sXG5cbiAgICAgICAgYWlfdmliZTogKGFpLnZpYmUgfHwgW10pLmpvaW4oXCIsIFwiKSxcbiAgICAgICAgYWlfb2JqZWN0czogKGFpLm9iamVjdHMgfHwgW10pLmpvaW4oXCIsIFwiKSxcbiAgICAgICAgYWlfc2NlbmVzOiAoYWkuc2NlbmVzIHx8IFtdKS5qb2luKFwiIHwgXCIpLFxuICAgICAgICBhaV9wZW9wbGU6IChhaS5wZW9wbGUgfHwgW10pLmpvaW4oXCIsIFwiKSxcbiAgICAgICAgYWlfbXVzdF9rZWVwOiAoYWkubXVzdF9rZWVwIHx8IFtdKS5qb2luKFwiLCBcIiksXG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgIHVybDogcmVzdWx0LnNlY3VyZV91cmwsXG4gICAgICBwdWJsaWNJZDogcmVzdWx0LnB1YmxpY19pZCxcbiAgICAgIHRpdGxlLFxuICAgICAgYWksIC8vIGZ1bGwgZGVzY3JpcHRvciBmb3IgeW91ciBEQlxuICAgICAgdGFnczogbWVyZ2VkVGFncyxcbiAgICAgIHBhcmVudElkczogcGFyZW50SWRzID8/IG51bGwsXG4gICAgICBjb21tdW5pdHk6IGNvbW11bml0eSA/PyBudWxsLFxuICAgIH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJVcGxvYWQgZXJyb3I6XCIsIGVycm9yKTtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7IGVycm9yOiBcIkZhaWxlZCB0byB1cGxvYWQgaW1hZ2VcIiB9LFxuICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgKTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsInYyIiwiY2xvdWRpbmFyeSIsIk9wZW5BSSIsInJ1bnRpbWUiLCJvcGVuYWkiLCJhcGlLZXkiLCJwcm9jZXNzIiwiZW52IiwiT1BFTkFJX0FQSV9LRVkiLCJjb25maWciLCJjbG91ZF9uYW1lIiwiQ0xPVURJTkFSWV9DTE9VRF9OQU1FIiwiYXBpX2tleSIsIkNMT1VESU5BUllfQVBJX0tFWSIsImFwaV9zZWNyZXQiLCJDTE9VRElOQVJZX0FQSV9TRUNSRVQiLCJkZWR1cExvd2VyIiwiYXJyIiwic2VlbiIsIlNldCIsIm91dCIsInQiLCJrIiwidHJpbSIsInRvTG93ZXJDYXNlIiwiaGFzIiwiYWRkIiwicHVzaCIsIlBPU1QiLCJyZXF1ZXN0IiwiaW1hZ2VVcmwiLCJ0aXRsZSIsInRhZ3MiLCJwYXJlbnRJZHMiLCJjb21tdW5pdHkiLCJqc29uIiwicmVzdWx0IiwidXBsb2FkZXIiLCJ1cGxvYWQiLCJmb2xkZXIiLCJjb250ZXh0IiwiYWx0IiwiY2FwdGlvbiIsIlN0cmluZyIsIm1vZGVyYXRpb24iLCJtb2RlcmF0aW9uQXJyIiwid2FzUmVqZWN0ZWQiLCJzb21lIiwibSIsInN0YXR1cyIsImtpbmQiLCJzdGFydHNXaXRoIiwiZXJyb3IiLCJzY2hlbWEiLCJuYW1lIiwic3RyaWN0IiwidHlwZSIsImFkZGl0aW9uYWxQcm9wZXJ0aWVzIiwicHJvcGVydGllcyIsImFsdFRleHQiLCJzb19tZV90eXBlIiwidHJlbmQiLCJmZWVsaW5nIiwic3ViamVjdCIsInNldHRpbmciLCJtZWRpdW0iLCJyZWFsaXNtIiwibGlnaHRpbmciLCJwYWxldHRlIiwiY29tcG9zaXRpb24iLCJzdHlsZSIsIml0ZW1zIiwibWluSXRlbXMiLCJtYXhJdGVtcyIsInZpYmUiLCJvYmplY3RzIiwic2NlbmVzIiwicGVvcGxlIiwibXVzdF9rZWVwIiwicmVxdWlyZWQiLCJ2aXNpb25Qcm9tcHQiLCJjb21wbGV0aW9uIiwiY2hhdCIsImNvbXBsZXRpb25zIiwiY3JlYXRlIiwibW9kZWwiLCJ0ZW1wZXJhdHVyZSIsIm1heF90b2tlbnMiLCJyZXNwb25zZV9mb3JtYXQiLCJqc29uX3NjaGVtYSIsIm1lc3NhZ2VzIiwicm9sZSIsImNvbnRlbnQiLCJ0ZXh0IiwiaW1hZ2VfdXJsIiwidXJsIiwic2VjdXJlX3VybCIsInJhdyIsImNob2ljZXMiLCJtZXNzYWdlIiwiYWkiLCJKU09OIiwicGFyc2UiLCJtZXJnZWRUYWdzIiwic3BsaXQiLCJzbGljZSIsImV4cGxpY2l0IiwicHVibGljX2lkIiwiam9pbiIsImFpX3RpdGxlIiwiYWlfY2FwdGlvbiIsImFpX3RyZW5kIiwiYWlfc29fbWVfdHlwZSIsImFpX2ZlZWxpbmciLCJhaV9zdHlsZSIsImFpX3N1YmplY3QiLCJhaV9zZXR0aW5nIiwiYWlfbWVkaXVtIiwiYWlfcmVhbGlzbSIsImFpX2xpZ2h0aW5nIiwiYWlfcGFsZXR0ZSIsImFpX2NvbXBvc2l0aW9uIiwiYWlfdmliZSIsImFpX29iamVjdHMiLCJhaV9zY2VuZXMiLCJhaV9wZW9wbGUiLCJhaV9tdXN0X2tlZXAiLCJwdWJsaWNJZCIsImNvbnNvbGUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/cloudinary/upload/route.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/formdata-node","vendor-chunks/ms","vendor-chunks/core-js","vendor-chunks/lodash","vendor-chunks/openai","vendor-chunks/cloudinary","vendor-chunks/form-data-encoder","vendor-chunks/whatwg-url","vendor-chunks/agentkeepalive","vendor-chunks/tr46","vendor-chunks/web-streams-polyfill","vendor-chunks/node-fetch","vendor-chunks/webidl-conversions","vendor-chunks/q","vendor-chunks/humanize-ms","vendor-chunks/event-target-shim","vendor-chunks/cloudinary-core","vendor-chunks/abort-controller"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcloudinary%2Fupload%2Froute&page=%2Fapi%2Fcloudinary%2Fupload%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcloudinary%2Fupload%2Froute.ts&appDir=D%3A%5CArtDocumentation%5C2024_ImageEcologySimulation%5CecologyAPI%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CArtDocumentation%5C2024_ImageEcologySimulation%5CecologyAPI&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();