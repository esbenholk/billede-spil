"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/generateImage/route";
exports.ids = ["app/api/generateImage/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("punycode");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "worker_threads":
/*!*********************************!*\
  !*** external "worker_threads" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("worker_threads");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "node:fs":
/*!**************************!*\
  !*** external "node:fs" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("node:fs");

/***/ }),

/***/ "node:stream":
/*!******************************!*\
  !*** external "node:stream" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:stream");

/***/ }),

/***/ "node:stream/web":
/*!**********************************!*\
  !*** external "node:stream/web" ***!
  \**********************************/
/***/ ((module) => {

module.exports = require("node:stream/web");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2FgenerateImage%2Froute&page=%2Fapi%2FgenerateImage%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2FgenerateImage%2Froute.ts&appDir=D%3A%5CArtDocumentation%5C2024_ImageEcologySimulation%5CecologyAPI%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CArtDocumentation%5C2024_ImageEcologySimulation%5CecologyAPI&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2FgenerateImage%2Froute&page=%2Fapi%2FgenerateImage%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2FgenerateImage%2Froute.ts&appDir=D%3A%5CArtDocumentation%5C2024_ImageEcologySimulation%5CecologyAPI%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CArtDocumentation%5C2024_ImageEcologySimulation%5CecologyAPI&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var D_ArtDocumentation_2024_ImageEcologySimulation_ecologyAPI_src_app_api_generateImage_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/generateImage/route.ts */ \"(rsc)/./src/app/api/generateImage/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/generateImage/route\",\n        pathname: \"/api/generateImage\",\n        filename: \"route\",\n        bundlePath: \"app/api/generateImage/route\"\n    },\n    resolvedPagePath: \"D:\\\\ArtDocumentation\\\\2024_ImageEcologySimulation\\\\ecologyAPI\\\\src\\\\app\\\\api\\\\generateImage\\\\route.ts\",\n    nextConfigOutput,\n    userland: D_ArtDocumentation_2024_ImageEcologySimulation_ecologyAPI_src_app_api_generateImage_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/generateImage/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZnZW5lcmF0ZUltYWdlJTJGcm91dGUmcGFnZT0lMkZhcGklMkZnZW5lcmF0ZUltYWdlJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGZ2VuZXJhdGVJbWFnZSUyRnJvdXRlLnRzJmFwcERpcj1EJTNBJTVDQXJ0RG9jdW1lbnRhdGlvbiU1QzIwMjRfSW1hZ2VFY29sb2d5U2ltdWxhdGlvbiU1Q2Vjb2xvZ3lBUEklNUNzcmMlNUNhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPUQlM0ElNUNBcnREb2N1bWVudGF0aW9uJTVDMjAyNF9JbWFnZUVjb2xvZ3lTaW11bGF0aW9uJTVDZWNvbG9neUFQSSZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDcUQ7QUFDbEk7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUU7QUFDekU7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUN1SDs7QUFFdkgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90cmVuZHMtYWktZ2VuZXJhdG9yLz9kNDQxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIkQ6XFxcXEFydERvY3VtZW50YXRpb25cXFxcMjAyNF9JbWFnZUVjb2xvZ3lTaW11bGF0aW9uXFxcXGVjb2xvZ3lBUElcXFxcc3JjXFxcXGFwcFxcXFxhcGlcXFxcZ2VuZXJhdGVJbWFnZVxcXFxyb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvZ2VuZXJhdGVJbWFnZS9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2dlbmVyYXRlSW1hZ2VcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL2dlbmVyYXRlSW1hZ2Uvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCJEOlxcXFxBcnREb2N1bWVudGF0aW9uXFxcXDIwMjRfSW1hZ2VFY29sb2d5U2ltdWxhdGlvblxcXFxlY29sb2d5QVBJXFxcXHNyY1xcXFxhcHBcXFxcYXBpXFxcXGdlbmVyYXRlSW1hZ2VcXFxccm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL2dlbmVyYXRlSW1hZ2Uvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2FgenerateImage%2Froute&page=%2Fapi%2FgenerateImage%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2FgenerateImage%2Froute.ts&appDir=D%3A%5CArtDocumentation%5C2024_ImageEcologySimulation%5CecologyAPI%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CArtDocumentation%5C2024_ImageEcologySimulation%5CecologyAPI&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/generateImage/route.ts":
/*!********************************************!*\
  !*** ./src/app/api/generateImage/route.ts ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST),\n/* harmony export */   runtime: () => (/* binding */ runtime)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var openai__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! openai */ \"(rsc)/./node_modules/openai/index.mjs\");\n// app/api/generateImage/route.ts\n\n\nconst runtime = \"nodejs\";\nconst openai = new openai__WEBPACK_IMPORTED_MODULE_1__[\"default\"]({\n    apiKey: process.env.OPENAI_API_KEY\n});\nconst uniq = (arr)=>Array.from(new Set(arr.filter(Boolean).map((s)=>String(s).trim())));\nfunction buildAnchors(d) {\n    const objects = Array.isArray(d?.objects) ? d.objects : [];\n    const vibe = Array.isArray(d?.vibe) ? d.vibe : [];\n    const people = Array.isArray(d?.people) ? d.people : [];\n    const mustKeep = Array.isArray(d?.must_keep) ? d.must_keep : [];\n    return uniq([\n        ...mustKeep,\n        ...objects.slice(0, 5),\n        ...vibe[0] ? [\n            vibe[0]\n        ] : [],\n        ...people[0] ? [\n            people[0]\n        ] : []\n    ]).slice(0, 10);\n}\nasync function POST(request) {\n    try {\n        const body = await request.json();\n        const { // new\n        parents = [], adjectives = \"\", communities = [], trends = [], extraPrompt = \"\", remixStrength = 0.7, // legacy compatibility\n        descriptions = [], styles = [], people = [], parentIds = [], size = \"1024x1024\" } = body ?? {};\n        const strength = Math.max(0, Math.min(1, remixStrength));\n        // Support old callers: if parents missing, fabricate from descriptions\n        const normalizedParents = Array.isArray(parents) && parents.length >= 2 ? parents : (descriptions || []).map((d, i)=>({\n                url: parentIds?.[i] || \"\",\n                descriptor: {\n                    description: d\n                }\n            }));\n        if (!Array.isArray(normalizedParents) || normalizedParents.length < 2) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Provide at least 2 parents.\"\n            }, {\n                status: 400\n            });\n        }\n        // Build summaries with anchors\n        const parentSummaries = normalizedParents.slice(0, 10).map((p, i)=>{\n            const d = p.descriptor || {};\n            return {\n                index: i + 1,\n                description: d.description || \"\",\n                subject: d.subject || \"\",\n                setting: d.setting || \"\",\n                style: d.style || \"\",\n                medium: d.medium || \"\",\n                realism: d.realism || \"\",\n                lighting: d.lighting || \"\",\n                palette: d.palette || \"\",\n                composition: d.composition || \"\",\n                trend: d.trend || \"\",\n                feeling: d.feeling || \"\",\n                anchors: buildAnchors(d)\n            };\n        });\n        // Ask LLM for a merged plan (looser + remixy)\n        const schema = {\n            name: \"RemixPlan\",\n            strict: true,\n            schema: {\n                type: \"object\",\n                additionalProperties: false,\n                properties: {\n                    scene: {\n                        type: \"string\"\n                    },\n                    subject: {\n                        type: \"string\"\n                    },\n                    setting: {\n                        type: \"string\"\n                    },\n                    composition: {\n                        type: \"string\"\n                    },\n                    medium: {\n                        type: \"string\"\n                    },\n                    realism: {\n                        type: \"string\"\n                    },\n                    lighting: {\n                        type: \"string\"\n                    },\n                    palette: {\n                        type: \"string\"\n                    },\n                    style_notes: {\n                        type: \"string\"\n                    },\n                    must_include: {\n                        type: \"array\",\n                        items: {\n                            type: \"string\"\n                        },\n                        minItems: 4,\n                        maxItems: 16\n                    },\n                    avoid: {\n                        type: \"array\",\n                        items: {\n                            type: \"string\"\n                        },\n                        minItems: 0,\n                        maxItems: 14\n                    },\n                    remix_directive: {\n                        type: \"string\"\n                    }\n                },\n                required: [\n                    \"scene\",\n                    \"subject\",\n                    \"setting\",\n                    \"composition\",\n                    \"medium\",\n                    \"realism\",\n                    \"lighting\",\n                    \"palette\",\n                    \"style_notes\",\n                    \"must_include\",\n                    \"avoid\",\n                    \"remix_directive\"\n                ]\n            }\n        };\n        const mergePrompt = [\n            `Create ONE coherent remix image prompt plan inspired by multiple parent descriptions.`,\n            `The output should feel like a NEW image inspired by the parents (not a literal collage).`,\n            `You may recompose, resize, fuse, and stylize elements for novelty.`,\n            `Include ~1–2 recognizable anchors from each parent summary.`,\n            `Unify into a single world; no grid/collage.`,\n            `Remix intensity remixStrength=${strength} (0 faithful → 1 wild).`,\n            `No text, watermark, UI.`,\n            \"\",\n            `Context tags:`,\n            adjectives ? `- vibe/tags: ${adjectives}` : \"\",\n            communities?.length ? `- community: ${communities.join(\", \")}` : \"\",\n            trends?.length ? `- trends: ${trends.join(\", \")}` : \"\",\n            extraPrompt ? `- extra: ${extraPrompt}` : \"\",\n            \"\",\n            `Parent summaries:`,\n            JSON.stringify(parentSummaries)\n        ].filter(Boolean).join(\"\\n\");\n        const planResp = await openai.chat.completions.create({\n            model: \"gpt-4o-mini\",\n            temperature: 0.6,\n            max_tokens: 650,\n            response_format: {\n                type: \"json_schema\",\n                json_schema: schema\n            },\n            messages: [\n                {\n                    role: \"system\",\n                    content: \"Return only JSON matching the schema. Keep it remixy and visual. Integrate anchors naturally rather than listing them.\"\n                },\n                {\n                    role: \"user\",\n                    content: mergePrompt\n                }\n            ]\n        });\n        const plan = JSON.parse(planResp.choices[0]?.message?.content ?? \"{}\");\n        const remixLine = strength >= 0.85 ? \"Highly remixed reinterpretation, bold recomposition, surprising fusions.\" : strength >= 0.55 ? \"Creative remix reinterpretation, allow recomposition and scale shifts.\" : \"Light remix, subtle rearrangements and stylized integrations.\";\n        const finalPrompt = [\n            `${plan.scene}. ${plan.subject}. ${plan.setting}.`,\n            remixLine,\n            plan.remix_directive ? plan.remix_directive : \"\",\n            `Composition: ${plan.composition}.`,\n            `Medium: ${plan.medium}, realism: ${plan.realism}.`,\n            `Lighting: ${plan.lighting}. Palette: ${plan.palette}.`,\n            plan.style_notes ? `Style: ${plan.style_notes}.` : \"\",\n            `Must include: ${uniq(plan.must_include || []).join(\", \")}.`,\n            plan.avoid?.length ? `Avoid: ${uniq(plan.avoid).join(\", \")}.` : \"\",\n            `Square image. No text, no watermark, no UI, no logos, no signatures.`\n        ].filter(Boolean).join(\" \");\n        // ✅ DALL·E 3 generation returns a URL\n        const image = await openai.images.generate({\n            model: \"dall-e-3\",\n            prompt: finalPrompt,\n            n: 1,\n            size\n        });\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            remixedPrompt: finalPrompt,\n            plan,\n            imageUrl: image.data?.[0]?.url ?? null,\n            parentUrls: normalizedParents.map((p)=>p.url).filter(Boolean)\n        });\n    } catch (error) {\n        console.error(\"Generation error (POST):\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Failed to generate content\"\n        }, {\n            status: 500\n        });\n    }\n}\n/** ---------- Existing GET (kept for compatibility) ---------- */ async function GET(request) {\n    try {\n        const url = new URL(request.url);\n        const prompt = url.searchParams.get(\"prompt\") || \"\";\n        const adjectives = url.searchParams.get(\"adjectives\") || \"\";\n        const completion = await openai.chat.completions.create({\n            model: \"gpt-3.5-turbo\",\n            messages: [\n                {\n                    role: \"user\",\n                    content: `pretend that you are an image prompt engineer that is trying to produce social media content.` + `We need to write an image prompt that expands on and depicts the following sentence: There is... ${prompt}. ` + `The image should fit this vibe: ${adjectives} and be in the style of mediaval drawings or post-internet graphics and sci-fi, ` + `please output an image prompt in english`\n                }\n            ],\n            max_tokens: 100\n        });\n        const sentence = (completion.choices[0].message.content || \"\").replace('\"', \"\");\n        const styleSuffix = \"the image should be in the style of mideaval drawings, fantasy, post-internet graphics and sci-fi. the image is not allowed to show any caption or UI element.\";\n        const image = await openai.images.generate({\n            model: \"dall-e-3\",\n            prompt: `${sentence}\\n${styleSuffix}`.trim(),\n            n: 1,\n            size: \"1024x1024\"\n        });\n        const data = {\n            prompt,\n            remixedPrompt: sentence,\n            imageUrl: image.data ? image.data[0].url : \"imageurlplaceholder\",\n            tags: adjectives\n        };\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(data);\n    } catch (error) {\n        console.error(\"Generation error (GET):\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Failed to generate content\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9nZW5lcmF0ZUltYWdlL3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQUEsaUNBQWlDO0FBQ1U7QUFDZjtBQUdyQixNQUFNRSxVQUFVLFNBQVM7QUFFaEMsTUFBTUMsU0FBUyxJQUFJRiw4Q0FBTUEsQ0FBQztJQUFFRyxRQUFRQyxRQUFRQyxHQUFHLENBQUNDLGNBQWM7QUFBQztBQTBCL0QsTUFBTUMsT0FBTyxDQUFDQyxNQUNaQyxNQUFNQyxJQUFJLENBQUMsSUFBSUMsSUFBSUgsSUFBSUksTUFBTSxDQUFDQyxTQUFTQyxHQUFHLENBQUMsQ0FBQ0MsSUFBTUMsT0FBT0QsR0FBR0UsSUFBSTtBQUVsRSxTQUFTQyxhQUFhQyxDQUErQjtJQUNuRCxNQUFNQyxVQUFVWCxNQUFNWSxPQUFPLENBQUNGLEdBQUdDLFdBQVdELEVBQUdDLE9BQU8sR0FBSSxFQUFFO0lBQzVELE1BQU1FLE9BQU9iLE1BQU1ZLE9BQU8sQ0FBQ0YsR0FBR0csUUFBUUgsRUFBR0csSUFBSSxHQUFJLEVBQUU7SUFDbkQsTUFBTUMsU0FBU2QsTUFBTVksT0FBTyxDQUFDRixHQUFHSSxVQUFVSixFQUFHSSxNQUFNLEdBQUksRUFBRTtJQUN6RCxNQUFNQyxXQUFXZixNQUFNWSxPQUFPLENBQUNGLEdBQUdNLGFBQWFOLEVBQUdNLFNBQVMsR0FBSSxFQUFFO0lBRWpFLE9BQU9sQixLQUFLO1dBQ1BpQjtXQUNBSixRQUFRTSxLQUFLLENBQUMsR0FBRztXQUNoQkosSUFBSSxDQUFDLEVBQUUsR0FBRztZQUFDQSxJQUFJLENBQUMsRUFBRTtTQUFDLEdBQUcsRUFBRTtXQUN4QkMsTUFBTSxDQUFDLEVBQUUsR0FBRztZQUFDQSxNQUFNLENBQUMsRUFBRTtTQUFDLEdBQUcsRUFBRTtLQUNqQyxFQUFFRyxLQUFLLENBQUMsR0FBRztBQUNkO0FBRU8sZUFBZUMsS0FBS0MsT0FBZ0I7SUFDekMsSUFBSTtRQUNGLE1BQU1DLE9BQU8sTUFBTUQsUUFBUUUsSUFBSTtRQUUv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R0YsTUFBTUMsY0FDSjtRQUVGLE1BQU1qQixRQUFRLE1BQU10RyxPQUFPdUcsTUFBTSxDQUFDQyxRQUFRLENBQUM7WUFDekNoQixPQUFPO1lBQ1BpQixRQUFRLENBQUMsRUFBRVksU0FBUyxFQUFFLEVBQUVFLFlBQVksQ0FBQyxDQUFDeEcsSUFBSTtZQUMxQzJGLEdBQUc7WUFDSHBFLE1BQU07UUFDUjtRQUVBLE1BQU11RSxPQUFPO1lBQ1hKO1lBQ0FFLGVBQWVVO1lBQ2ZULFVBQVVOLE1BQU1PLElBQUksR0FBR1AsTUFBTU8sSUFBSSxDQUFDLEVBQUUsQ0FBQy9ELEdBQUcsR0FBRztZQUMzQzBFLE1BQU0xRjtRQUNSO1FBRUEsT0FBT2pDLHFEQUFZQSxDQUFDK0IsSUFBSSxDQUFDaUY7SUFDM0IsRUFBRSxPQUFPNUQsT0FBTztRQUNkOEQsUUFBUTlELEtBQUssQ0FBQywyQkFBMkJBO1FBQ3pDLE9BQU9wRCxxREFBWUEsQ0FBQytCLElBQUksQ0FDdEI7WUFBRXFCLE9BQU87UUFBNkIsR0FDdEM7WUFBRUMsUUFBUTtRQUFJO0lBRWxCO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90cmVuZHMtYWktZ2VuZXJhdG9yLy4vc3JjL2FwcC9hcGkvZ2VuZXJhdGVJbWFnZS9yb3V0ZS50cz9lZDdkIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIGFwcC9hcGkvZ2VuZXJhdGVJbWFnZS9yb3V0ZS50c1xuaW1wb3J0IHsgTmV4dFJlc3BvbnNlIH0gZnJvbSBcIm5leHQvc2VydmVyXCI7XG5pbXBvcnQgT3BlbkFJIGZyb20gXCJvcGVuYWlcIjtcbmltcG9ydCB7IHYyIGFzIGNsb3VkaW5hcnkgfSBmcm9tIFwiY2xvdWRpbmFyeVwiO1xuXG5leHBvcnQgY29uc3QgcnVudGltZSA9IFwibm9kZWpzXCI7XG5cbmNvbnN0IG9wZW5haSA9IG5ldyBPcGVuQUkoeyBhcGlLZXk6IHByb2Nlc3MuZW52Lk9QRU5BSV9BUElfS0VZIH0pO1xuXG50eXBlIFBhcmVudERlc2NyaXB0b3IgPSB7XG4gIHRpdGxlPzogc3RyaW5nO1xuICBkZXNjcmlwdGlvbj86IHN0cmluZztcbiAgc3ViamVjdD86IHN0cmluZztcbiAgc2V0dGluZz86IHN0cmluZztcbiAgbWVkaXVtPzogc3RyaW5nO1xuICByZWFsaXNtPzogc3RyaW5nO1xuICBsaWdodGluZz86IHN0cmluZztcbiAgcGFsZXR0ZT86IHN0cmluZztcbiAgY29tcG9zaXRpb24/OiBzdHJpbmc7XG4gIHN0eWxlPzogc3RyaW5nO1xuICB2aWJlPzogc3RyaW5nW107XG4gIG9iamVjdHM/OiBzdHJpbmdbXTtcbiAgcGVvcGxlPzogc3RyaW5nW107XG4gIHRyZW5kPzogc3RyaW5nO1xuICBmZWVsaW5nPzogc3RyaW5nO1xuICBtdXN0X2tlZXA/OiBzdHJpbmdbXTtcbn07XG5cbnR5cGUgUmVtaXhQYXJlbnQgPSB7XG4gIHVybDogc3RyaW5nO1xuICBkZXNjcmlwdG9yPzogUGFyZW50RGVzY3JpcHRvcjtcbn07XG5cbmNvbnN0IHVuaXEgPSAoYXJyOiBzdHJpbmdbXSkgPT5cbiAgQXJyYXkuZnJvbShuZXcgU2V0KGFyci5maWx0ZXIoQm9vbGVhbikubWFwKChzKSA9PiBTdHJpbmcocykudHJpbSgpKSkpO1xuXG5mdW5jdGlvbiBidWlsZEFuY2hvcnMoZDogUGFyZW50RGVzY3JpcHRvciB8IHVuZGVmaW5lZCkge1xuICBjb25zdCBvYmplY3RzID0gQXJyYXkuaXNBcnJheShkPy5vYmplY3RzKSA/IGQhLm9iamVjdHMhIDogW107XG4gIGNvbnN0IHZpYmUgPSBBcnJheS5pc0FycmF5KGQ/LnZpYmUpID8gZCEudmliZSEgOiBbXTtcbiAgY29uc3QgcGVvcGxlID0gQXJyYXkuaXNBcnJheShkPy5wZW9wbGUpID8gZCEucGVvcGxlISA6IFtdO1xuICBjb25zdCBtdXN0S2VlcCA9IEFycmF5LmlzQXJyYXkoZD8ubXVzdF9rZWVwKSA/IGQhLm11c3Rfa2VlcCEgOiBbXTtcblxuICByZXR1cm4gdW5pcShbXG4gICAgLi4ubXVzdEtlZXAsXG4gICAgLi4ub2JqZWN0cy5zbGljZSgwLCA1KSxcbiAgICAuLi4odmliZVswXSA/IFt2aWJlWzBdXSA6IFtdKSxcbiAgICAuLi4ocGVvcGxlWzBdID8gW3Blb3BsZVswXV0gOiBbXSksXG4gIF0pLnNsaWNlKDAsIDEwKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxdWVzdDogUmVxdWVzdCkge1xuICB0cnkge1xuICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKTtcblxuICAgIGNvbnN0IHtcbiAgICAgIC8vIG5ld1xuICAgICAgcGFyZW50cyA9IFtdLFxuICAgICAgYWRqZWN0aXZlcyA9IFwiXCIsXG4gICAgICBjb21tdW5pdGllcyA9IFtdLFxuICAgICAgdHJlbmRzID0gW10sXG4gICAgICBleHRyYVByb21wdCA9IFwiXCIsXG4gICAgICByZW1peFN0cmVuZ3RoID0gMC43LFxuXG4gICAgICAvLyBsZWdhY3kgY29tcGF0aWJpbGl0eVxuICAgICAgZGVzY3JpcHRpb25zID0gW10sXG4gICAgICBzdHlsZXMgPSBbXSxcbiAgICAgIHBlb3BsZSA9IFtdLFxuICAgICAgcGFyZW50SWRzID0gW10sXG4gICAgICBzaXplID0gXCIxMDI0eDEwMjRcIixcbiAgICB9OiB7XG4gICAgICBwYXJlbnRzPzogUmVtaXhQYXJlbnRbXTtcbiAgICAgIGFkamVjdGl2ZXM/OiBzdHJpbmc7XG4gICAgICBjb21tdW5pdGllcz86IHN0cmluZ1tdO1xuICAgICAgdHJlbmRzPzogc3RyaW5nW107XG4gICAgICBleHRyYVByb21wdD86IHN0cmluZztcbiAgICAgIHJlbWl4U3RyZW5ndGg/OiBudW1iZXI7XG5cbiAgICAgIGRlc2NyaXB0aW9ucz86IHN0cmluZ1tdO1xuICAgICAgc3R5bGVzPzogc3RyaW5nW107XG4gICAgICBwZW9wbGU/OiBzdHJpbmdbXTtcbiAgICAgIHBhcmVudElkcz86IHN0cmluZ1tdO1xuXG4gICAgICBzaXplPzogXCIxMDI0eDEwMjRcIiB8IFwiMTc5MngxMDI0XCIgfCBcIjEwMjR4MTc5MlwiO1xuICAgIH0gPSBib2R5ID8/IHt9O1xuXG4gICAgY29uc3Qgc3RyZW5ndGggPSBNYXRoLm1heCgwLCBNYXRoLm1pbigxLCByZW1peFN0cmVuZ3RoKSk7XG5cbiAgICAvLyBTdXBwb3J0IG9sZCBjYWxsZXJzOiBpZiBwYXJlbnRzIG1pc3NpbmcsIGZhYnJpY2F0ZSBmcm9tIGRlc2NyaXB0aW9uc1xuICAgIGNvbnN0IG5vcm1hbGl6ZWRQYXJlbnRzOiBSZW1peFBhcmVudFtdID1cbiAgICAgIEFycmF5LmlzQXJyYXkocGFyZW50cykgJiYgcGFyZW50cy5sZW5ndGggPj0gMlxuICAgICAgICA/IHBhcmVudHNcbiAgICAgICAgOiAoZGVzY3JpcHRpb25zIHx8IFtdKS5tYXAoKGQsIGkpID0+ICh7XG4gICAgICAgICAgICB1cmw6IHBhcmVudElkcz8uW2ldIHx8IFwiXCIsXG4gICAgICAgICAgICBkZXNjcmlwdG9yOiB7IGRlc2NyaXB0aW9uOiBkIH0sXG4gICAgICAgICAgfSkpO1xuXG4gICAgaWYgKCFBcnJheS5pc0FycmF5KG5vcm1hbGl6ZWRQYXJlbnRzKSB8fCBub3JtYWxpemVkUGFyZW50cy5sZW5ndGggPCAyKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6IFwiUHJvdmlkZSBhdCBsZWFzdCAyIHBhcmVudHMuXCIgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICApO1xuICAgIH1cblxuICAgIC8vIEJ1aWxkIHN1bW1hcmllcyB3aXRoIGFuY2hvcnNcbiAgICBjb25zdCBwYXJlbnRTdW1tYXJpZXMgPSBub3JtYWxpemVkUGFyZW50cy5zbGljZSgwLCAxMCkubWFwKChwLCBpKSA9PiB7XG4gICAgICBjb25zdCBkID0gcC5kZXNjcmlwdG9yIHx8IHt9O1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgaW5kZXg6IGkgKyAxLFxuICAgICAgICBkZXNjcmlwdGlvbjogZC5kZXNjcmlwdGlvbiB8fCBcIlwiLFxuICAgICAgICBzdWJqZWN0OiBkLnN1YmplY3QgfHwgXCJcIixcbiAgICAgICAgc2V0dGluZzogZC5zZXR0aW5nIHx8IFwiXCIsXG4gICAgICAgIHN0eWxlOiBkLnN0eWxlIHx8IFwiXCIsXG4gICAgICAgIG1lZGl1bTogZC5tZWRpdW0gfHwgXCJcIixcbiAgICAgICAgcmVhbGlzbTogZC5yZWFsaXNtIHx8IFwiXCIsXG4gICAgICAgIGxpZ2h0aW5nOiBkLmxpZ2h0aW5nIHx8IFwiXCIsXG4gICAgICAgIHBhbGV0dGU6IGQucGFsZXR0ZSB8fCBcIlwiLFxuICAgICAgICBjb21wb3NpdGlvbjogZC5jb21wb3NpdGlvbiB8fCBcIlwiLFxuICAgICAgICB0cmVuZDogZC50cmVuZCB8fCBcIlwiLFxuICAgICAgICBmZWVsaW5nOiBkLmZlZWxpbmcgfHwgXCJcIixcbiAgICAgICAgYW5jaG9yczogYnVpbGRBbmNob3JzKGQpLFxuICAgICAgfTtcbiAgICB9KTtcblxuICAgIC8vIEFzayBMTE0gZm9yIGEgbWVyZ2VkIHBsYW4gKGxvb3NlciArIHJlbWl4eSlcbiAgICBjb25zdCBzY2hlbWEgPSB7XG4gICAgICBuYW1lOiBcIlJlbWl4UGxhblwiLFxuICAgICAgc3RyaWN0OiB0cnVlLFxuICAgICAgc2NoZW1hOiB7XG4gICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgIGFkZGl0aW9uYWxQcm9wZXJ0aWVzOiBmYWxzZSxcbiAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgIHNjZW5lOiB7IHR5cGU6IFwic3RyaW5nXCIgfSxcbiAgICAgICAgICBzdWJqZWN0OiB7IHR5cGU6IFwic3RyaW5nXCIgfSxcbiAgICAgICAgICBzZXR0aW5nOiB7IHR5cGU6IFwic3RyaW5nXCIgfSxcbiAgICAgICAgICBjb21wb3NpdGlvbjogeyB0eXBlOiBcInN0cmluZ1wiIH0sXG4gICAgICAgICAgbWVkaXVtOiB7IHR5cGU6IFwic3RyaW5nXCIgfSxcbiAgICAgICAgICByZWFsaXNtOiB7IHR5cGU6IFwic3RyaW5nXCIgfSxcbiAgICAgICAgICBsaWdodGluZzogeyB0eXBlOiBcInN0cmluZ1wiIH0sXG4gICAgICAgICAgcGFsZXR0ZTogeyB0eXBlOiBcInN0cmluZ1wiIH0sXG4gICAgICAgICAgc3R5bGVfbm90ZXM6IHsgdHlwZTogXCJzdHJpbmdcIiB9LFxuICAgICAgICAgIG11c3RfaW5jbHVkZToge1xuICAgICAgICAgICAgdHlwZTogXCJhcnJheVwiLFxuICAgICAgICAgICAgaXRlbXM6IHsgdHlwZTogXCJzdHJpbmdcIiB9LFxuICAgICAgICAgICAgbWluSXRlbXM6IDQsXG4gICAgICAgICAgICBtYXhJdGVtczogMTYsXG4gICAgICAgICAgfSxcbiAgICAgICAgICBhdm9pZDoge1xuICAgICAgICAgICAgdHlwZTogXCJhcnJheVwiLFxuICAgICAgICAgICAgaXRlbXM6IHsgdHlwZTogXCJzdHJpbmdcIiB9LFxuICAgICAgICAgICAgbWluSXRlbXM6IDAsXG4gICAgICAgICAgICBtYXhJdGVtczogMTQsXG4gICAgICAgICAgfSxcbiAgICAgICAgICByZW1peF9kaXJlY3RpdmU6IHsgdHlwZTogXCJzdHJpbmdcIiB9LFxuICAgICAgICB9LFxuICAgICAgICByZXF1aXJlZDogW1xuICAgICAgICAgIFwic2NlbmVcIixcbiAgICAgICAgICBcInN1YmplY3RcIixcbiAgICAgICAgICBcInNldHRpbmdcIixcbiAgICAgICAgICBcImNvbXBvc2l0aW9uXCIsXG4gICAgICAgICAgXCJtZWRpdW1cIixcbiAgICAgICAgICBcInJlYWxpc21cIixcbiAgICAgICAgICBcImxpZ2h0aW5nXCIsXG4gICAgICAgICAgXCJwYWxldHRlXCIsXG4gICAgICAgICAgXCJzdHlsZV9ub3Rlc1wiLFxuICAgICAgICAgIFwibXVzdF9pbmNsdWRlXCIsXG4gICAgICAgICAgXCJhdm9pZFwiLFxuICAgICAgICAgIFwicmVtaXhfZGlyZWN0aXZlXCIsXG4gICAgICAgIF0sXG4gICAgICB9LFxuICAgIH0gYXMgY29uc3Q7XG5cbiAgICBjb25zdCBtZXJnZVByb21wdCA9IFtcbiAgICAgIGBDcmVhdGUgT05FIGNvaGVyZW50IHJlbWl4IGltYWdlIHByb21wdCBwbGFuIGluc3BpcmVkIGJ5IG11bHRpcGxlIHBhcmVudCBkZXNjcmlwdGlvbnMuYCxcbiAgICAgIGBUaGUgb3V0cHV0IHNob3VsZCBmZWVsIGxpa2UgYSBORVcgaW1hZ2UgaW5zcGlyZWQgYnkgdGhlIHBhcmVudHMgKG5vdCBhIGxpdGVyYWwgY29sbGFnZSkuYCxcbiAgICAgIGBZb3UgbWF5IHJlY29tcG9zZSwgcmVzaXplLCBmdXNlLCBhbmQgc3R5bGl6ZSBlbGVtZW50cyBmb3Igbm92ZWx0eS5gLFxuICAgICAgYEluY2x1ZGUgfjHigJMyIHJlY29nbml6YWJsZSBhbmNob3JzIGZyb20gZWFjaCBwYXJlbnQgc3VtbWFyeS5gLFxuICAgICAgYFVuaWZ5IGludG8gYSBzaW5nbGUgd29ybGQ7IG5vIGdyaWQvY29sbGFnZS5gLFxuICAgICAgYFJlbWl4IGludGVuc2l0eSByZW1peFN0cmVuZ3RoPSR7c3RyZW5ndGh9ICgwIGZhaXRoZnVsIOKGkiAxIHdpbGQpLmAsXG4gICAgICBgTm8gdGV4dCwgd2F0ZXJtYXJrLCBVSS5gLFxuICAgICAgXCJcIixcbiAgICAgIGBDb250ZXh0IHRhZ3M6YCxcbiAgICAgIGFkamVjdGl2ZXMgPyBgLSB2aWJlL3RhZ3M6ICR7YWRqZWN0aXZlc31gIDogXCJcIixcbiAgICAgIGNvbW11bml0aWVzPy5sZW5ndGggPyBgLSBjb21tdW5pdHk6ICR7Y29tbXVuaXRpZXMuam9pbihcIiwgXCIpfWAgOiBcIlwiLFxuICAgICAgdHJlbmRzPy5sZW5ndGggPyBgLSB0cmVuZHM6ICR7dHJlbmRzLmpvaW4oXCIsIFwiKX1gIDogXCJcIixcbiAgICAgIGV4dHJhUHJvbXB0ID8gYC0gZXh0cmE6ICR7ZXh0cmFQcm9tcHR9YCA6IFwiXCIsXG4gICAgICBcIlwiLFxuICAgICAgYFBhcmVudCBzdW1tYXJpZXM6YCxcbiAgICAgIEpTT04uc3RyaW5naWZ5KHBhcmVudFN1bW1hcmllcyksXG4gICAgXVxuICAgICAgLmZpbHRlcihCb29sZWFuKVxuICAgICAgLmpvaW4oXCJcXG5cIik7XG5cbiAgICBjb25zdCBwbGFuUmVzcCA9IGF3YWl0IG9wZW5haS5jaGF0LmNvbXBsZXRpb25zLmNyZWF0ZSh7XG4gICAgICBtb2RlbDogXCJncHQtNG8tbWluaVwiLFxuICAgICAgdGVtcGVyYXR1cmU6IDAuNixcbiAgICAgIG1heF90b2tlbnM6IDY1MCxcbiAgICAgIHJlc3BvbnNlX2Zvcm1hdDogeyB0eXBlOiBcImpzb25fc2NoZW1hXCIsIGpzb25fc2NoZW1hOiBzY2hlbWEgfSxcbiAgICAgIG1lc3NhZ2VzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICByb2xlOiBcInN5c3RlbVwiLFxuICAgICAgICAgIGNvbnRlbnQ6XG4gICAgICAgICAgICBcIlJldHVybiBvbmx5IEpTT04gbWF0Y2hpbmcgdGhlIHNjaGVtYS4gS2VlcCBpdCByZW1peHkgYW5kIHZpc3VhbC4gSW50ZWdyYXRlIGFuY2hvcnMgbmF0dXJhbGx5IHJhdGhlciB0aGFuIGxpc3RpbmcgdGhlbS5cIixcbiAgICAgICAgfSxcbiAgICAgICAgeyByb2xlOiBcInVzZXJcIiwgY29udGVudDogbWVyZ2VQcm9tcHQgfSxcbiAgICAgIF0sXG4gICAgfSk7XG5cbiAgICBjb25zdCBwbGFuID0gSlNPTi5wYXJzZShwbGFuUmVzcC5jaG9pY2VzWzBdPy5tZXNzYWdlPy5jb250ZW50ID8/IFwie31cIik7XG5cbiAgICBjb25zdCByZW1peExpbmUgPVxuICAgICAgc3RyZW5ndGggPj0gMC44NVxuICAgICAgICA/IFwiSGlnaGx5IHJlbWl4ZWQgcmVpbnRlcnByZXRhdGlvbiwgYm9sZCByZWNvbXBvc2l0aW9uLCBzdXJwcmlzaW5nIGZ1c2lvbnMuXCJcbiAgICAgICAgOiBzdHJlbmd0aCA+PSAwLjU1XG4gICAgICAgID8gXCJDcmVhdGl2ZSByZW1peCByZWludGVycHJldGF0aW9uLCBhbGxvdyByZWNvbXBvc2l0aW9uIGFuZCBzY2FsZSBzaGlmdHMuXCJcbiAgICAgICAgOiBcIkxpZ2h0IHJlbWl4LCBzdWJ0bGUgcmVhcnJhbmdlbWVudHMgYW5kIHN0eWxpemVkIGludGVncmF0aW9ucy5cIjtcblxuICAgIGNvbnN0IGZpbmFsUHJvbXB0ID0gW1xuICAgICAgYCR7cGxhbi5zY2VuZX0uICR7cGxhbi5zdWJqZWN0fS4gJHtwbGFuLnNldHRpbmd9LmAsXG4gICAgICByZW1peExpbmUsXG4gICAgICBwbGFuLnJlbWl4X2RpcmVjdGl2ZSA/IHBsYW4ucmVtaXhfZGlyZWN0aXZlIDogXCJcIixcbiAgICAgIGBDb21wb3NpdGlvbjogJHtwbGFuLmNvbXBvc2l0aW9ufS5gLFxuICAgICAgYE1lZGl1bTogJHtwbGFuLm1lZGl1bX0sIHJlYWxpc206ICR7cGxhbi5yZWFsaXNtfS5gLFxuICAgICAgYExpZ2h0aW5nOiAke3BsYW4ubGlnaHRpbmd9LiBQYWxldHRlOiAke3BsYW4ucGFsZXR0ZX0uYCxcbiAgICAgIHBsYW4uc3R5bGVfbm90ZXMgPyBgU3R5bGU6ICR7cGxhbi5zdHlsZV9ub3Rlc30uYCA6IFwiXCIsXG4gICAgICBgTXVzdCBpbmNsdWRlOiAke3VuaXEocGxhbi5tdXN0X2luY2x1ZGUgfHwgW10pLmpvaW4oXCIsIFwiKX0uYCxcbiAgICAgIHBsYW4uYXZvaWQ/Lmxlbmd0aCA/IGBBdm9pZDogJHt1bmlxKHBsYW4uYXZvaWQpLmpvaW4oXCIsIFwiKX0uYCA6IFwiXCIsXG4gICAgICBgU3F1YXJlIGltYWdlLiBObyB0ZXh0LCBubyB3YXRlcm1hcmssIG5vIFVJLCBubyBsb2dvcywgbm8gc2lnbmF0dXJlcy5gLFxuICAgIF1cbiAgICAgIC5maWx0ZXIoQm9vbGVhbilcbiAgICAgIC5qb2luKFwiIFwiKTtcblxuICAgIC8vIOKchSBEQUxMwrdFIDMgZ2VuZXJhdGlvbiByZXR1cm5zIGEgVVJMXG4gICAgY29uc3QgaW1hZ2UgPSBhd2FpdCBvcGVuYWkuaW1hZ2VzLmdlbmVyYXRlKHtcbiAgICAgIG1vZGVsOiBcImRhbGwtZS0zXCIsXG4gICAgICBwcm9tcHQ6IGZpbmFsUHJvbXB0LFxuICAgICAgbjogMSxcbiAgICAgIHNpemUsXG4gICAgfSk7XG5cbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgcmVtaXhlZFByb21wdDogZmluYWxQcm9tcHQsXG4gICAgICBwbGFuLFxuICAgICAgaW1hZ2VVcmw6IGltYWdlLmRhdGE/LlswXT8udXJsID8/IG51bGwsXG4gICAgICBwYXJlbnRVcmxzOiBub3JtYWxpemVkUGFyZW50cy5tYXAoKHApID0+IHAudXJsKS5maWx0ZXIoQm9vbGVhbiksXG4gICAgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkdlbmVyYXRpb24gZXJyb3IgKFBPU1QpOlwiLCBlcnJvcik7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBlcnJvcjogXCJGYWlsZWQgdG8gZ2VuZXJhdGUgY29udGVudFwiIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH1cbiAgICApO1xuICB9XG59XG5cbi8qKiAtLS0tLS0tLS0tIEV4aXN0aW5nIEdFVCAoa2VwdCBmb3IgY29tcGF0aWJpbGl0eSkgLS0tLS0tLS0tLSAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIEdFVChyZXF1ZXN0OiBSZXF1ZXN0KSB7XG4gIHRyeSB7XG4gICAgY29uc3QgdXJsID0gbmV3IFVSTChyZXF1ZXN0LnVybCk7XG4gICAgY29uc3QgcHJvbXB0ID0gdXJsLnNlYXJjaFBhcmFtcy5nZXQoXCJwcm9tcHRcIikgfHwgXCJcIjtcbiAgICBjb25zdCBhZGplY3RpdmVzID0gdXJsLnNlYXJjaFBhcmFtcy5nZXQoXCJhZGplY3RpdmVzXCIpIHx8IFwiXCI7XG5cbiAgICBjb25zdCBjb21wbGV0aW9uID0gYXdhaXQgb3BlbmFpLmNoYXQuY29tcGxldGlvbnMuY3JlYXRlKHtcbiAgICAgIG1vZGVsOiBcImdwdC0zLjUtdHVyYm9cIixcbiAgICAgIG1lc3NhZ2VzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICByb2xlOiBcInVzZXJcIixcbiAgICAgICAgICBjb250ZW50OlxuICAgICAgICAgICAgYHByZXRlbmQgdGhhdCB5b3UgYXJlIGFuIGltYWdlIHByb21wdCBlbmdpbmVlciB0aGF0IGlzIHRyeWluZyB0byBwcm9kdWNlIHNvY2lhbCBtZWRpYSBjb250ZW50LmAgK1xuICAgICAgICAgICAgYFdlIG5lZWQgdG8gd3JpdGUgYW4gaW1hZ2UgcHJvbXB0IHRoYXQgZXhwYW5kcyBvbiBhbmQgZGVwaWN0cyB0aGUgZm9sbG93aW5nIHNlbnRlbmNlOiBUaGVyZSBpcy4uLiAke3Byb21wdH0uIGAgK1xuICAgICAgICAgICAgYFRoZSBpbWFnZSBzaG91bGQgZml0IHRoaXMgdmliZTogJHthZGplY3RpdmVzfSBhbmQgYmUgaW4gdGhlIHN0eWxlIG9mIG1lZGlhdmFsIGRyYXdpbmdzIG9yIHBvc3QtaW50ZXJuZXQgZ3JhcGhpY3MgYW5kIHNjaS1maSwgYCArXG4gICAgICAgICAgICBgcGxlYXNlIG91dHB1dCBhbiBpbWFnZSBwcm9tcHQgaW4gZW5nbGlzaGAsXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgICAgbWF4X3Rva2VuczogMTAwLFxuICAgIH0pO1xuXG4gICAgY29uc3Qgc2VudGVuY2UgPSAoY29tcGxldGlvbi5jaG9pY2VzWzBdLm1lc3NhZ2UuY29udGVudCB8fCBcIlwiKS5yZXBsYWNlKFxuICAgICAgJ1wiJyxcbiAgICAgIFwiXCJcbiAgICApO1xuXG4gICAgY29uc3Qgc3R5bGVTdWZmaXggPVxuICAgICAgXCJ0aGUgaW1hZ2Ugc2hvdWxkIGJlIGluIHRoZSBzdHlsZSBvZiBtaWRlYXZhbCBkcmF3aW5ncywgZmFudGFzeSwgcG9zdC1pbnRlcm5ldCBncmFwaGljcyBhbmQgc2NpLWZpLiB0aGUgaW1hZ2UgaXMgbm90IGFsbG93ZWQgdG8gc2hvdyBhbnkgY2FwdGlvbiBvciBVSSBlbGVtZW50LlwiO1xuXG4gICAgY29uc3QgaW1hZ2UgPSBhd2FpdCBvcGVuYWkuaW1hZ2VzLmdlbmVyYXRlKHtcbiAgICAgIG1vZGVsOiBcImRhbGwtZS0zXCIsXG4gICAgICBwcm9tcHQ6IGAke3NlbnRlbmNlfVxcbiR7c3R5bGVTdWZmaXh9YC50cmltKCksXG4gICAgICBuOiAxLFxuICAgICAgc2l6ZTogXCIxMDI0eDEwMjRcIixcbiAgICB9KTtcblxuICAgIGNvbnN0IGRhdGEgPSB7XG4gICAgICBwcm9tcHQsXG4gICAgICByZW1peGVkUHJvbXB0OiBzZW50ZW5jZSxcbiAgICAgIGltYWdlVXJsOiBpbWFnZS5kYXRhID8gaW1hZ2UuZGF0YVswXS51cmwgOiBcImltYWdldXJscGxhY2Vob2xkZXJcIixcbiAgICAgIHRhZ3M6IGFkamVjdGl2ZXMsXG4gICAgfTtcblxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihkYXRhKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiR2VuZXJhdGlvbiBlcnJvciAoR0VUKTpcIiwgZXJyb3IpO1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHsgZXJyb3I6IFwiRmFpbGVkIHRvIGdlbmVyYXRlIGNvbnRlbnRcIiB9LFxuICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgKTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsIk9wZW5BSSIsInJ1bnRpbWUiLCJvcGVuYWkiLCJhcGlLZXkiLCJwcm9jZXNzIiwiZW52IiwiT1BFTkFJX0FQSV9LRVkiLCJ1bmlxIiwiYXJyIiwiQXJyYXkiLCJmcm9tIiwiU2V0IiwiZmlsdGVyIiwiQm9vbGVhbiIsIm1hcCIsInMiLCJTdHJpbmciLCJ0cmltIiwiYnVpbGRBbmNob3JzIiwiZCIsIm9iamVjdHMiLCJpc0FycmF5IiwidmliZSIsInBlb3BsZSIsIm11c3RLZWVwIiwibXVzdF9rZWVwIiwic2xpY2UiLCJQT1NUIiwicmVxdWVzdCIsImJvZHkiLCJqc29uIiwicGFyZW50cyIsImFkamVjdGl2ZXMiLCJjb21tdW5pdGllcyIsInRyZW5kcyIsImV4dHJhUHJvbXB0IiwicmVtaXhTdHJlbmd0aCIsImRlc2NyaXB0aW9ucyIsInN0eWxlcyIsInBhcmVudElkcyIsInNpemUiLCJzdHJlbmd0aCIsIk1hdGgiLCJtYXgiLCJtaW4iLCJub3JtYWxpemVkUGFyZW50cyIsImxlbmd0aCIsImkiLCJ1cmwiLCJkZXNjcmlwdG9yIiwiZGVzY3JpcHRpb24iLCJlcnJvciIsInN0YXR1cyIsInBhcmVudFN1bW1hcmllcyIsInAiLCJpbmRleCIsInN1YmplY3QiLCJzZXR0aW5nIiwic3R5bGUiLCJtZWRpdW0iLCJyZWFsaXNtIiwibGlnaHRpbmciLCJwYWxldHRlIiwiY29tcG9zaXRpb24iLCJ0cmVuZCIsImZlZWxpbmciLCJhbmNob3JzIiwic2NoZW1hIiwibmFtZSIsInN0cmljdCIsInR5cGUiLCJhZGRpdGlvbmFsUHJvcGVydGllcyIsInByb3BlcnRpZXMiLCJzY2VuZSIsInN0eWxlX25vdGVzIiwibXVzdF9pbmNsdWRlIiwiaXRlbXMiLCJtaW5JdGVtcyIsIm1heEl0ZW1zIiwiYXZvaWQiLCJyZW1peF9kaXJlY3RpdmUiLCJyZXF1aXJlZCIsIm1lcmdlUHJvbXB0Iiwiam9pbiIsIkpTT04iLCJzdHJpbmdpZnkiLCJwbGFuUmVzcCIsImNoYXQiLCJjb21wbGV0aW9ucyIsImNyZWF0ZSIsIm1vZGVsIiwidGVtcGVyYXR1cmUiLCJtYXhfdG9rZW5zIiwicmVzcG9uc2VfZm9ybWF0IiwianNvbl9zY2hlbWEiLCJtZXNzYWdlcyIsInJvbGUiLCJjb250ZW50IiwicGxhbiIsInBhcnNlIiwiY2hvaWNlcyIsIm1lc3NhZ2UiLCJyZW1peExpbmUiLCJmaW5hbFByb21wdCIsImltYWdlIiwiaW1hZ2VzIiwiZ2VuZXJhdGUiLCJwcm9tcHQiLCJuIiwicmVtaXhlZFByb21wdCIsImltYWdlVXJsIiwiZGF0YSIsInBhcmVudFVybHMiLCJjb25zb2xlIiwiR0VUIiwiVVJMIiwic2VhcmNoUGFyYW1zIiwiZ2V0IiwiY29tcGxldGlvbiIsInNlbnRlbmNlIiwicmVwbGFjZSIsInN0eWxlU3VmZml4IiwidGFncyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/generateImage/route.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/formdata-node","vendor-chunks/ms","vendor-chunks/openai","vendor-chunks/tr46","vendor-chunks/web-streams-polyfill","vendor-chunks/node-fetch","vendor-chunks/whatwg-url","vendor-chunks/event-target-shim","vendor-chunks/agentkeepalive","vendor-chunks/form-data-encoder","vendor-chunks/webidl-conversions","vendor-chunks/abort-controller","vendor-chunks/humanize-ms"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2FgenerateImage%2Froute&page=%2Fapi%2FgenerateImage%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2FgenerateImage%2Froute.ts&appDir=D%3A%5CArtDocumentation%5C2024_ImageEcologySimulation%5CecologyAPI%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CArtDocumentation%5C2024_ImageEcologySimulation%5CecologyAPI&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();