"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/generateImage/route";
exports.ids = ["app/api/generateImage/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("punycode");

/***/ }),

/***/ "querystring":
/*!******************************!*\
  !*** external "querystring" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("querystring");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "worker_threads":
/*!*********************************!*\
  !*** external "worker_threads" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("worker_threads");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "node:fs":
/*!**************************!*\
  !*** external "node:fs" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("node:fs");

/***/ }),

/***/ "node:stream":
/*!******************************!*\
  !*** external "node:stream" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:stream");

/***/ }),

/***/ "node:stream/web":
/*!**********************************!*\
  !*** external "node:stream/web" ***!
  \**********************************/
/***/ ((module) => {

module.exports = require("node:stream/web");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2FgenerateImage%2Froute&page=%2Fapi%2FgenerateImage%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2FgenerateImage%2Froute.ts&appDir=D%3A%5CArtDocumentation%5C2024_ImageEcologySimulation%5CecologyAPI%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CArtDocumentation%5C2024_ImageEcologySimulation%5CecologyAPI&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2FgenerateImage%2Froute&page=%2Fapi%2FgenerateImage%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2FgenerateImage%2Froute.ts&appDir=D%3A%5CArtDocumentation%5C2024_ImageEcologySimulation%5CecologyAPI%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CArtDocumentation%5C2024_ImageEcologySimulation%5CecologyAPI&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var D_ArtDocumentation_2024_ImageEcologySimulation_ecologyAPI_src_app_api_generateImage_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/generateImage/route.ts */ \"(rsc)/./src/app/api/generateImage/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/generateImage/route\",\n        pathname: \"/api/generateImage\",\n        filename: \"route\",\n        bundlePath: \"app/api/generateImage/route\"\n    },\n    resolvedPagePath: \"D:\\\\ArtDocumentation\\\\2024_ImageEcologySimulation\\\\ecologyAPI\\\\src\\\\app\\\\api\\\\generateImage\\\\route.ts\",\n    nextConfigOutput,\n    userland: D_ArtDocumentation_2024_ImageEcologySimulation_ecologyAPI_src_app_api_generateImage_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/generateImage/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZnZW5lcmF0ZUltYWdlJTJGcm91dGUmcGFnZT0lMkZhcGklMkZnZW5lcmF0ZUltYWdlJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGZ2VuZXJhdGVJbWFnZSUyRnJvdXRlLnRzJmFwcERpcj1EJTNBJTVDQXJ0RG9jdW1lbnRhdGlvbiU1QzIwMjRfSW1hZ2VFY29sb2d5U2ltdWxhdGlvbiU1Q2Vjb2xvZ3lBUEklNUNzcmMlNUNhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPUQlM0ElNUNBcnREb2N1bWVudGF0aW9uJTVDMjAyNF9JbWFnZUVjb2xvZ3lTaW11bGF0aW9uJTVDZWNvbG9neUFQSSZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDcUQ7QUFDbEk7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUU7QUFDekU7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUN1SDs7QUFFdkgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90cmVuZHMtYWktZ2VuZXJhdG9yLz9kNDQxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIkQ6XFxcXEFydERvY3VtZW50YXRpb25cXFxcMjAyNF9JbWFnZUVjb2xvZ3lTaW11bGF0aW9uXFxcXGVjb2xvZ3lBUElcXFxcc3JjXFxcXGFwcFxcXFxhcGlcXFxcZ2VuZXJhdGVJbWFnZVxcXFxyb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvZ2VuZXJhdGVJbWFnZS9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2dlbmVyYXRlSW1hZ2VcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL2dlbmVyYXRlSW1hZ2Uvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCJEOlxcXFxBcnREb2N1bWVudGF0aW9uXFxcXDIwMjRfSW1hZ2VFY29sb2d5U2ltdWxhdGlvblxcXFxlY29sb2d5QVBJXFxcXHNyY1xcXFxhcHBcXFxcYXBpXFxcXGdlbmVyYXRlSW1hZ2VcXFxccm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL2dlbmVyYXRlSW1hZ2Uvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2FgenerateImage%2Froute&page=%2Fapi%2FgenerateImage%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2FgenerateImage%2Froute.ts&appDir=D%3A%5CArtDocumentation%5C2024_ImageEcologySimulation%5CecologyAPI%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CArtDocumentation%5C2024_ImageEcologySimulation%5CecologyAPI&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/generateImage/route.ts":
/*!********************************************!*\
  !*** ./src/app/api/generateImage/route.ts ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST),\n/* harmony export */   runtime: () => (/* binding */ runtime)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var openai__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! openai */ \"(rsc)/./node_modules/openai/index.mjs\");\n/* harmony import */ var cloudinary__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! cloudinary */ \"(rsc)/./node_modules/cloudinary/cloudinary.js\");\n/* harmony import */ var cloudinary__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(cloudinary__WEBPACK_IMPORTED_MODULE_1__);\n// app/api/generateImage/route.ts\n\n\n\nconst runtime = \"nodejs\";\nconst openai = new openai__WEBPACK_IMPORTED_MODULE_2__[\"default\"]({\n    apiKey: process.env.OPENAI_API_KEY\n});\n/** Helper: safe join */ const join = (arr, sep = \", \")=>Array.isArray(arr) ? arr.filter(Boolean).map((s)=>s.trim()).join(sep) : \"\";\ncloudinary__WEBPACK_IMPORTED_MODULE_1__.v2.config({\n    cloud_name: process.env.CLOUDINARY_CLOUD_NAME,\n    api_key: process.env.CLOUDINARY_API_KEY,\n    api_secret: process.env.CLOUDINARY_API_SECRET\n});\nfunction uniq(arr) {\n    return Array.from(new Set(arr.map((s)=>s.trim()).filter(Boolean)));\n}\nfunction buildAnchors(d) {\n    const objects = Array.isArray(d?.objects) ? d.objects : [];\n    const vibe = Array.isArray(d?.vibe) ? d.vibe : [];\n    const people = Array.isArray(d?.people) ? d.people : [];\n    const mustKeep = Array.isArray(d?.must_keep) ? d.must_keep : [];\n    // Anchors: explicit must_keep first, then top objects + 1 vibe + 1 person cue\n    const anchors = uniq([\n        ...mustKeep,\n        ...objects.slice(0, 5),\n        ...vibe[0] ? [\n            vibe[0]\n        ] : [],\n        ...people[0] ? [\n            people[0]\n        ] : []\n    ]).slice(0, 10);\n    return anchors;\n}\nasync function urlToFile(url, fallbackName) {\n    const res = await fetch(url);\n    if (!res.ok) throw new Error(`Failed to fetch image: ${url} (${res.status})`);\n    const contentType = res.headers.get(\"content-type\") || \"image/jpeg\";\n    const ext = contentType.includes(\"png\") ? \"png\" : contentType.includes(\"webp\") ? \"webp\" : \"jpg\";\n    const ab = await res.arrayBuffer();\n    const buf = Buffer.from(ab);\n    // Node 18+ has File/Blob\n    return new File([\n        buf\n    ], `${fallbackName}.${ext}`, {\n        type: contentType\n    });\n}\nfunction requireEnv(name) {\n    const v = process.env[name];\n    if (!v || !v.trim()) throw new Error(`Missing env var: ${name}`);\n    return v.trim();\n}\nfunction getCloudinary() {\n    cloudinary__WEBPACK_IMPORTED_MODULE_1__.v2.config({\n        cloud_name: requireEnv(\"CLOUDINARY_CLOUD_NAME\"),\n        api_key: requireEnv(\"CLOUDINARY_API_KEY\"),\n        api_secret: requireEnv(\"CLOUDINARY_API_SECRET\"),\n        secure: true,\n        timeout: 120000\n    });\n    return cloudinary__WEBPACK_IMPORTED_MODULE_1__.v2;\n}\nasync function uploadB64ToCloudinary(b64, opts) {\n    if (!b64 || typeof b64 !== \"string\") throw new Error(\"Missing base64 image\");\n    // If you ever pass data URLs, normalize:\n    const cleaned = b64.replace(/^data:image\\/\\w+;base64,/, \"\");\n    const buffer = Buffer.from(cleaned, \"base64\");\n    const cld = getCloudinary();\n    return await new Promise((resolve, reject)=>{\n        const stream = cld.uploader.upload_stream({\n            folder: opts?.folder ?? \"imageEcology/placeholders\",\n            resource_type: \"image\",\n            // Let Cloudinary detect; or set \"jpg\" since OpenAI produced jpeg:\n            format: \"jpg\",\n            transformation: [\n                {\n                    quality: \"auto\"\n                },\n                {\n                    fetch_format: \"auto\"\n                }\n            ],\n            context: opts?.title ? {\n                caption: opts.title,\n                alt: opts.title\n            } : undefined\n        }, (err, result)=>{\n            if (err) {\n                // Cloudinary err often includes http_code + message\n                console.error(\"Cloudinary upload_stream error:\", {\n                    message: err.message,\n                    http_code: err.http_code,\n                    name: err.name\n                });\n                return reject(err);\n            }\n            if (!result?.secure_url) return reject(new Error(\"Cloudinary returned no secure_url\"));\n            resolve(result.secure_url);\n        });\n        stream.end(buffer);\n    });\n}\nasync function POST(request) {\n    try {\n        const body = await request.json();\n        console.log(\"POST REQ: body\", body);\n        console.log(\"CLOUDINARY_CLOUD_NAME set?\", !!process.env.CLOUDINARY_CLOUD_NAME);\n        console.log(\"CLOUDINARY_API_KEY set?\", !!process.env.CLOUDINARY_API_KEY);\n        console.log(\"CLOUDINARY_API_SECRET set?\", !!process.env.CLOUDINARY_API_SECRET);\n        const { parents = [], adjectives = \"\", communities = [], trends = [], extraPrompt = \"\", size = \"1024x1024\", // ✅ new “looseness” knobs (optional from frontend)\n        remixStrength = 0.65, anchorPerParent = \"1-2\" } = body ?? {};\n        if (!Array.isArray(parents) || parents.length < 2) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Provide at least 2 parents.\"\n            }, {\n                status: 400\n            });\n        }\n        const strength = Math.max(0, Math.min(1, remixStrength));\n        // 1) Download parent images -> Files\n        const imageFiles = await Promise.all(parents.slice(0, 16).map((p, i)=>urlToFile(p.url, `parent-${i + 1}`)));\n        // 2) Build per-parent anchor summaries (high signal)\n        const parentSummaries = parents.slice(0, 16).map((p, i)=>{\n            const d = p.descriptor || {};\n            const anchors = buildAnchors(d);\n            return {\n                index: i + 1,\n                url: p.url,\n                subject: d.subject || \"\",\n                setting: d.setting || \"\",\n                medium: d.medium || \"\",\n                realism: d.realism || \"\",\n                lighting: d.lighting || \"\",\n                palette: d.palette || \"\",\n                composition: d.composition || \"\",\n                vibe: Array.isArray(d.vibe) ? d.vibe : [],\n                people: Array.isArray(d.people) ? d.people : [],\n                objects: Array.isArray(d.objects) ? d.objects : [],\n                trend: d.trend || \"\",\n                feeling: d.feeling || \"\",\n                style: d.style || \"\",\n                anchors\n            };\n        });\n        console.log(\"SUMMARIZES PARENTS\", parentSummaries);\n        // 3) Ask LLM for a *merged plan* (Structured Outputs), then render a final prompt\n        const schema = {\n            name: \"RemixPlan\",\n            strict: true,\n            schema: {\n                type: \"object\",\n                additionalProperties: false,\n                properties: {\n                    scene: {\n                        type: \"string\"\n                    },\n                    subject: {\n                        type: \"string\"\n                    },\n                    setting: {\n                        type: \"string\"\n                    },\n                    composition: {\n                        type: \"string\"\n                    },\n                    medium: {\n                        type: \"string\"\n                    },\n                    realism: {\n                        type: \"string\"\n                    },\n                    lighting: {\n                        type: \"string\"\n                    },\n                    palette: {\n                        type: \"string\"\n                    },\n                    style_notes: {\n                        type: \"string\"\n                    },\n                    must_include: {\n                        type: \"array\",\n                        items: {\n                            type: \"string\"\n                        },\n                        minItems: 4,\n                        maxItems: 16\n                    },\n                    avoid: {\n                        type: \"array\",\n                        items: {\n                            type: \"string\"\n                        },\n                        minItems: 0,\n                        maxItems: 14\n                    },\n                    // ✅ new: give the model explicit “remix permission” in output too\n                    remix_directive: {\n                        type: \"string\"\n                    }\n                },\n                required: [\n                    \"scene\",\n                    \"subject\",\n                    \"setting\",\n                    \"composition\",\n                    \"medium\",\n                    \"realism\",\n                    \"lighting\",\n                    \"palette\",\n                    \"style_notes\",\n                    \"must_include\",\n                    \"avoid\",\n                    \"remix_directive\"\n                ]\n            }\n        };\n        // ✅ NEW: creative remix rules + less rigid anchors + composition freedom\n        // We still ensure recognizability via must_include, but allow re-layout/fusion.\n        const mergePrompt = [\n            `Create ONE coherent remix plan from multiple parent images.`,\n            ``,\n            `Remix intent (critical):`,\n            `- The output should feel like a NEW image inspired by the parents, not a faithful copy.`,\n            `- You are allowed to reinterpret, resize, relocate, fuse, or stylize elements from all parents.`,\n            `- Preserve recognizability, but not exact layout, camera angle, or proportions.`,\n            `- You MAY change composition, perspective, framing, scale, and staging for higher impact.`,\n            `- Prefer surprising, meme-forward recombinations while keeping it visually coherent.`,\n            ``,\n            `Anchor rules:`,\n            `- Include at least ${anchorPerParent} recognizable anchor items from EACH parent (use parentSummaries[*].anchors).`,\n            `- Anchors can appear as props, background motifs, wardrobe details, environment cues, or fused elements.`,\n            `- Do NOT just “list” anchors; integrate them naturally into the scene.`,\n            ``,\n            `Style rules:`,\n            `- Choose ONE dominant medium + realism; harmonize lighting/palette.`,\n            `- If parents conflict, blend them into a single aesthetic (do not enumerate styles).`,\n            ``,\n            `Output constraints:`,\n            `- Unify into a single world (no grid/collage).`,\n            `- Keep it social-media-friendly and visually striking.`,\n            `- No text, no watermark, no UI.`,\n            ``,\n            `Creative looseness:`,\n            `- remixStrength=${strength} where 0=faithful edit and 1=highly remixed.`,\n            `- At higher remixStrength, push more transformation and unexpected composition shifts.`,\n            ``,\n            `Context tags:`,\n            adjectives ? `- vibe/tags: ${adjectives}` : \"\",\n            communities?.length ? `- community: ${communities.join(\", \")}` : \"\",\n            trends?.length ? `- trends: ${trends.join(\", \")}` : \"\",\n            extraPrompt ? `- extra: ${extraPrompt}` : \"\",\n            \"\",\n            `Parent summaries (anchors + style fields):`,\n            JSON.stringify(parentSummaries)\n        ].filter(Boolean).join(\"\\n\");\n        const planResp = await openai.chat.completions.create({\n            model: \"gpt-4o-mini\",\n            temperature: 0.55,\n            max_tokens: 650,\n            response_format: {\n                type: \"json_schema\",\n                json_schema: schema\n            },\n            messages: [\n                {\n                    role: \"system\",\n                    content: \"Return only JSON matching the schema. Prefer concrete visual anchors. Keep the plan remixy, not literal. Use remixStrength to decide how bold to be.\"\n                },\n                {\n                    role: \"user\",\n                    content: mergePrompt\n                }\n            ]\n        });\n        const planRaw = planResp.choices[0]?.message?.content ?? \"{}\";\n        const plan = JSON.parse(planRaw);\n        // ✅ NEW: bake in “remix permission” directly into the final prompt\n        // Also: scale the language based on remixStrength.\n        const remixLine = strength >= 0.8 ? \"Highly remixed reinterpretation with bold recomposition and surprising fusions.\" : strength >= 0.5 ? \"Creative remix reinterpretation; allow recomposition, scale shifts, and fused elements.\" : \"Light remix; small but noticeable rearrangements and stylized integrations.\";\n        const finalPrompt = [\n            // Core\n            `${plan.scene}. ${plan.subject}. ${plan.setting}.`,\n            // Remix directive (important for the image model)\n            remixLine,\n            plan.remix_directive ? plan.remix_directive : \"\",\n            // Visual control (but not too rigid)\n            `Composition: ${plan.composition}.`,\n            `Medium: ${plan.medium}, realism: ${plan.realism}.`,\n            `Lighting: ${plan.lighting}. Palette: ${plan.palette}.`,\n            plan.style_notes ? `Style: ${plan.style_notes}.` : \"\",\n            // Anchors\n            `Must include (integrated naturally): ${uniq(plan.must_include).join(\", \")}.`,\n            plan.avoid?.length ? `Avoid: ${uniq(plan.avoid).join(\", \")}.` : \"\",\n            // Universal constraints\n            `No text, no watermark, no UI, no logos, no signatures.`,\n            `Square image.`\n        ].filter(Boolean).join(\" \");\n        console.log(\"has final prompt\", finalPrompt);\n        // 4) Image remix using multi-image edits (array syntax)\n        const form = new FormData();\n        form.append(\"model\", \"gpt-image-1.5\");\n        form.append(\"prompt\", finalPrompt);\n        form.append(\"size\", size || \"1024x1024\");\n        form.append(\"output_format\", \"jpeg\");\n        // ✅ keep multi-image, but allow a softer influence by ordering:\n        // Put the \"base\" first; others follow. (Many models implicitly bias earlier inputs.)\n        for(let i = 0; i < imageFiles.length; i++){\n            form.append(\"image[]\", imageFiles[i]);\n        }\n        const res = await fetch(\"https://api.openai.com/v1/images/edits\", {\n            method: \"POST\",\n            headers: {\n                Authorization: `Bearer ${process.env.OPENAI_API_KEY}`\n            },\n            body: form\n        });\n        if (!res.ok) {\n            const err = await res.text();\n            throw new Error(`OpenAI image edit failed: ${err}`);\n        }\n        const img = await res.json();\n        console.log(\"has image\", img);\n        const b64 = img.data?.[0]?.b64_json;\n        if (!b64) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"No image returned.\"\n            }, {\n                status: 500\n            });\n        }\n        // 5) Upload remix output to Cloudinary\n        //const remixUrl = await uploadB64ToCloudinary(b64);\n        const remixUrl = await uploadB64ToCloudinary(b64);\n        console.log(\"uploaded to cloudinary temp folder\", remixUrl);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            remixedPrompt: finalPrompt,\n            plan,\n            remixStrength: strength,\n            imageUrl: remixUrl,\n            parentUrls: parents.map((p)=>p.url)\n        });\n    } catch (err) {\n        console.error(\"Remix error:\", err);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Failed to remix images\",\n            message: err?.message ?? String(err),\n            cloudinary_http_code: err?.http_code,\n            name: err?.name\n        }, {\n            status: 500\n        });\n    }\n}\n/** ---------- Existing GET (kept for compatibility) ---------- */ async function GET(request) {\n    try {\n        const url = new URL(request.url);\n        const prompt = url.searchParams.get(\"prompt\") || \"\";\n        const adjectives = url.searchParams.get(\"adjectives\") || \"\";\n        const completion = await openai.chat.completions.create({\n            model: \"gpt-3.5-turbo\",\n            messages: [\n                {\n                    role: \"user\",\n                    content: `pretend that you are an image prompt engineer that is trying to produce social media content.` + `We need to write an image prompt that expands on and depicts the following sentence: There is... ${prompt}. ` + `The image should fit this vibe: ${adjectives} and be in the style of mediaval drawings or post-internet graphics and sci-fi, ` + `please output an image prompt in english`\n                }\n            ],\n            max_tokens: 100\n        });\n        const sentence = (completion.choices[0].message.content || \"\").replace('\"', \"\");\n        const styleSuffix = \"the image should be in the style of mideaval drawings, fantasy, post-internet graphics and sci-fi. the image is not allowed to show any caption or UI element.\";\n        const image = await openai.images.generate({\n            model: \"dall-e-3\",\n            prompt: `${sentence}\\n${styleSuffix}`.trim(),\n            n: 1,\n            size: \"1024x1024\"\n        });\n        const data = {\n            prompt,\n            remixedPrompt: sentence,\n            imageUrl: image.data ? image.data[0].url : \"imageurlplaceholder\",\n            tags: adjectives\n        };\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(data);\n    } catch (error) {\n        console.error(\"Generation error (GET):\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Failed to generate content\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9nZW5lcmF0ZUltYWdlL3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBQSxpQ0FBaUM7QUFDVTtBQUNmO0FBQ2tCO0FBRXZDLE1BQU1JLFVBQVUsU0FBUztBQUVoQyxNQUFNQyxTQUFTLElBQUlKLDhDQUFNQSxDQUFDO0lBQUVLLFFBQVFDLFFBQVFDLEdBQUcsQ0FBQ0MsY0FBYztBQUFDO0FBUy9ELHNCQUFzQixHQUN0QixNQUFNQyxPQUFPLENBQUNDLEtBQXVCQyxNQUFNLElBQUksR0FDN0NDLE1BQU1DLE9BQU8sQ0FBQ0gsT0FDVkEsSUFDR0ksTUFBTSxDQUFDQyxTQUNQQyxHQUFHLENBQUMsQ0FBQ0MsSUFBTUEsRUFBRUMsSUFBSSxJQUNqQlQsSUFBSSxDQUFDRSxPQUNSO0FBRU5ULDBDQUFVQSxDQUFDaUIsTUFBTSxDQUFDO0lBQ2hCQyxZQUFZZCxRQUFRQyxHQUFHLENBQUNjLHFCQUFxQjtJQUM3Q0MsU0FBU2hCLFFBQVFDLEdBQUcsQ0FBQ2dCLGtCQUFrQjtJQUN2Q0MsWUFBWWxCLFFBQVFDLEdBQUcsQ0FBQ2tCLHFCQUFxQjtBQUMvQztBQWtDQSxTQUFTQyxLQUFLaEIsR0FBYTtJQUN6QixPQUFPRSxNQUFNZSxJQUFJLENBQUMsSUFBSUMsSUFBSWxCLElBQUlNLEdBQUcsQ0FBQyxDQUFDQyxJQUFNQSxFQUFFQyxJQUFJLElBQUlKLE1BQU0sQ0FBQ0M7QUFDNUQ7QUFFQSxTQUFTYyxhQUFhQyxDQUErQjtJQUNuRCxNQUFNQyxVQUFVbkIsTUFBTUMsT0FBTyxDQUFDaUIsR0FBR0MsV0FBV0QsRUFBR0MsT0FBTyxHQUFJLEVBQUU7SUFDNUQsTUFBTUMsT0FBT3BCLE1BQU1DLE9BQU8sQ0FBQ2lCLEdBQUdFLFFBQVFGLEVBQUdFLElBQUksR0FBSSxFQUFFO0lBQ25ELE1BQU1DLFNBQVNyQixNQUFNQyxPQUFPLENBQUNpQixHQUFHRyxVQUFVSCxFQUFHRyxNQUFNLEdBQUksRUFBRTtJQUN6RCxNQUFNQyxXQUFX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LENBQUMsR0FDL0YsQ0FBQyxpR0FBaUcsRUFBRXdCLE9BQU8sRUFBRSxDQUFDLEdBQzlHLENBQUMsZ0NBQWdDLEVBQUVoRixXQUFXLGdGQUFnRixDQUFDLEdBQy9ILENBQUMsd0NBQXdDLENBQUM7Z0JBQzlDO2FBQ0Q7WUFDRG1ELFlBQVk7UUFDZDtRQUVBLE1BQU1nQyxXQUFXLENBQUNELFdBQVd4QixPQUFPLENBQUMsRUFBRSxDQUFDcEUsT0FBTyxDQUFDa0UsT0FBTyxJQUFJLEVBQUMsRUFBRzFGLE9BQU8sQ0FDcEUsS0FDQTtRQUdGLE1BQU1zSCxjQUNKO1FBRUYsTUFBTUMsUUFBUSxNQUFNdEwsT0FBT3VMLE1BQU0sQ0FBQ0MsUUFBUSxDQUFDO1lBQ3pDdEMsT0FBTztZQUNQK0IsUUFBUSxDQUFDLEVBQUVHLFNBQVMsRUFBRSxFQUFFQyxZQUFZLENBQUMsQ0FBQ3ZLLElBQUk7WUFDMUMySyxHQUFHO1lBQ0hwRixNQUFNO1FBQ1I7UUFFQSxNQUFNa0UsT0FBTztZQUNYVTtZQUNBUCxlQUFlVTtZQUNmVCxVQUFVVyxNQUFNZixJQUFJLEdBQUdlLE1BQU1mLElBQUksQ0FBQyxFQUFFLENBQUNwSSxHQUFHLEdBQUc7WUFDM0N1SixNQUFNekY7UUFDUjtRQUVBLE9BQU90RyxxREFBWUEsQ0FBQ21HLElBQUksQ0FBQ3lFO0lBQzNCLEVBQUUsT0FBT2pGLE9BQU87UUFDZEQsUUFBUUMsS0FBSyxDQUFDLDJCQUEyQkE7UUFDekMsT0FBTzNGLHFEQUFZQSxDQUFDbUcsSUFBSSxDQUN0QjtZQUFFUixPQUFPO1FBQTZCLEdBQ3RDO1lBQUU3QyxRQUFRO1FBQUk7SUFFbEI7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3RyZW5kcy1haS1nZW5lcmF0b3IvLi9zcmMvYXBwL2FwaS9nZW5lcmF0ZUltYWdlL3JvdXRlLnRzP2VkN2QiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gYXBwL2FwaS9nZW5lcmF0ZUltYWdlL3JvdXRlLnRzXG5pbXBvcnQgeyBOZXh0UmVzcG9uc2UgfSBmcm9tIFwibmV4dC9zZXJ2ZXJcIjtcbmltcG9ydCBPcGVuQUkgZnJvbSBcIm9wZW5haVwiO1xuaW1wb3J0IHsgdjIgYXMgY2xvdWRpbmFyeSB9IGZyb20gXCJjbG91ZGluYXJ5XCI7XG5cbmV4cG9ydCBjb25zdCBydW50aW1lID0gXCJub2RlanNcIjtcblxuY29uc3Qgb3BlbmFpID0gbmV3IE9wZW5BSSh7IGFwaUtleTogcHJvY2Vzcy5lbnYuT1BFTkFJX0FQSV9LRVkgfSk7XG5cbmV4cG9ydCBpbnRlcmZhY2UgR2VuZXJhdGlvblJlc3VsdCB7XG4gIHNlbnRlbmNlOiBzdHJpbmc7XG4gIGltYWdlVXJsOiBzdHJpbmc7XG4gIHRyZW5kczogc3RyaW5nW107XG4gIGdlbzogc3RyaW5nO1xufVxuXG4vKiogSGVscGVyOiBzYWZlIGpvaW4gKi9cbmNvbnN0IGpvaW4gPSAoYXJyPzogc3RyaW5nW10gfCBudWxsLCBzZXAgPSBcIiwgXCIpID0+XG4gIEFycmF5LmlzQXJyYXkoYXJyKVxuICAgID8gYXJyXG4gICAgICAgIC5maWx0ZXIoQm9vbGVhbilcbiAgICAgICAgLm1hcCgocykgPT4gcy50cmltKCkpXG4gICAgICAgIC5qb2luKHNlcClcbiAgICA6IFwiXCI7XG5cbmNsb3VkaW5hcnkuY29uZmlnKHtcbiAgY2xvdWRfbmFtZTogcHJvY2Vzcy5lbnYuQ0xPVURJTkFSWV9DTE9VRF9OQU1FLFxuICBhcGlfa2V5OiBwcm9jZXNzLmVudi5DTE9VRElOQVJZX0FQSV9LRVksXG4gIGFwaV9zZWNyZXQ6IHByb2Nlc3MuZW52LkNMT1VESU5BUllfQVBJX1NFQ1JFVCxcbn0pO1xuXG50eXBlIFBhcmVudERlc2NyaXB0b3IgPSB7XG4gIC8vIE1pbmltYWxcbiAgdGl0bGU/OiBzdHJpbmc7XG4gIGRlc2NyaXB0aW9uPzogc3RyaW5nO1xuXG4gIC8vIE5ldyBzdHJ1Y3R1cmVkIGZpZWxkcyAocmVjb21tZW5kZWQpXG4gIHN1YmplY3Q/OiBzdHJpbmc7XG4gIHNldHRpbmc/OiBzdHJpbmc7XG4gIG1lZGl1bT86IHN0cmluZzsgLy8gXCIzRCByZW5kZXJcIiB8IFwicGhvdG9ncmFwaFwiIHwgXCJpbGx1c3RyYXRpb25cIiBldGMuXG4gIHJlYWxpc20/OiBzdHJpbmc7IC8vIFwicGhvdG9yZWFsaXN0aWNcIiB8IFwic3R5bGl6ZWRcIiBldGMuXG4gIGxpZ2h0aW5nPzogc3RyaW5nO1xuICBwYWxldHRlPzogc3RyaW5nO1xuICBjb21wb3NpdGlvbj86IHN0cmluZztcblxuICAvLyBFeGlzdGluZyBmaWVsZHMgeW91IGFscmVhZHkgaGF2ZVxuICBzdHlsZT86IHN0cmluZztcbiAgdmliZT86IHN0cmluZ1tdO1xuICBvYmplY3RzPzogc3RyaW5nW107XG4gIHBlb3BsZT86IHN0cmluZ1tdO1xuICB0cmVuZD86IHN0cmluZztcbiAgZmVlbGluZz86IHN0cmluZztcblxuICAvLyBBbmNob3JzXG4gIG11c3Rfa2VlcD86IHN0cmluZ1tdOyAvLyAz4oCTOCBpdGVtcyB0aGF0IHNob3VsZCBzdXJ2aXZlIHRoZSByZW1peFxufTtcblxudHlwZSBSZW1peFBhcmVudCA9IHtcbiAgdXJsOiBzdHJpbmc7IC8vIENsb3VkaW5hcnkgVVJMIG9yIGFueSBwdWJsaWMgVVJMXG4gIGRlc2NyaXB0b3I/OiBQYXJlbnREZXNjcmlwdG9yO1xufTtcblxuXG5mdW5jdGlvbiB1bmlxKGFycjogc3RyaW5nW10pIHtcbiAgcmV0dXJuIEFycmF5LmZyb20obmV3IFNldChhcnIubWFwKChzKSA9PiBzLnRyaW0oKSkuZmlsdGVyKEJvb2xlYW4pKSk7XG59XG5cbmZ1bmN0aW9uIGJ1aWxkQW5jaG9ycyhkOiBQYXJlbnREZXNjcmlwdG9yIHwgdW5kZWZpbmVkKSB7XG4gIGNvbnN0IG9iamVjdHMgPSBBcnJheS5pc0FycmF5KGQ/Lm9iamVjdHMpID8gZCEub2JqZWN0cyEgOiBbXTtcbiAgY29uc3QgdmliZSA9IEFycmF5LmlzQXJyYXkoZD8udmliZSkgPyBkIS52aWJlISA6IFtdO1xuICBjb25zdCBwZW9wbGUgPSBBcnJheS5pc0FycmF5KGQ/LnBlb3BsZSkgPyBkIS5wZW9wbGUhIDogW107XG4gIGNvbnN0IG11c3RLZWVwID0gQXJyYXkuaXNBcnJheShkPy5tdXN0X2tlZXApID8gZCEubXVzdF9rZWVwISA6IFtdO1xuXG4gIC8vIEFuY2hvcnM6IGV4cGxpY2l0IG11c3Rfa2VlcCBmaXJzdCwgdGhlbiB0b3Agb2JqZWN0cyArIDEgdmliZSArIDEgcGVyc29uIGN1ZVxuICBjb25zdCBhbmNob3JzID0gdW5pcShbXG4gICAgLi4ubXVzdEtlZXAsXG4gICAgLi4ub2JqZWN0cy5zbGljZSgwLCA1KSxcbiAgICAuLi4odmliZVswXSA/IFt2aWJlWzBdXSA6IFtdKSxcbiAgICAuLi4ocGVvcGxlWzBdID8gW3Blb3BsZVswXV0gOiBbXSksXG4gIF0pLnNsaWNlKDAsIDEwKTtcblxuICByZXR1cm4gYW5jaG9ycztcbn1cblxuYXN5bmMgZnVuY3Rpb24gdXJsVG9GaWxlKHVybDogc3RyaW5nLCBmYWxsYmFja05hbWU6IHN0cmluZyk6IFByb21pc2U8RmlsZT4ge1xuICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaCh1cmwpO1xuICBpZiAoIXJlcy5vaykgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gZmV0Y2ggaW1hZ2U6ICR7dXJsfSAoJHtyZXMuc3RhdHVzfSlgKTtcblxuICBjb25zdCBjb250ZW50VHlwZSA9IHJlcy5oZWFkZXJzLmdldChcImNvbnRlbnQtdHlwZVwiKSB8fCBcImltYWdlL2pwZWdcIjtcbiAgY29uc3QgZXh0ID0gY29udGVudFR5cGUuaW5jbHVkZXMoXCJwbmdcIilcbiAgICA/IFwicG5nXCJcbiAgICA6IGNvbnRlbnRUeXBlLmluY2x1ZGVzKFwid2VicFwiKVxuICAgID8gXCJ3ZWJwXCJcbiAgICA6IFwianBnXCI7XG5cbiAgY29uc3QgYWIgPSBhd2FpdCByZXMuYXJyYXlCdWZmZXIoKTtcbiAgY29uc3QgYnVmID0gQnVmZmVyLmZyb20oYWIpO1xuXG4gIC8vIE5vZGUgMTgrIGhhcyBGaWxlL0Jsb2JcbiAgcmV0dXJuIG5ldyBGaWxlKFtidWZdLCBgJHtmYWxsYmFja05hbWV9LiR7ZXh0fWAsIHsgdHlwZTogY29udGVudFR5cGUgfSk7XG59XG5cbmZ1bmN0aW9uIHJlcXVpcmVFbnYobmFtZTogc3RyaW5nKSB7XG4gIGNvbnN0IHYgPSBwcm9jZXNzLmVudltuYW1lXTtcbiAgaWYgKCF2IHx8ICF2LnRyaW0oKSkgdGhyb3cgbmV3IEVycm9yKGBNaXNzaW5nIGVudiB2YXI6ICR7bmFtZX1gKTtcbiAgcmV0dXJuIHYudHJpbSgpO1xufVxuXG5mdW5jdGlvbiBnZXRDbG91ZGluYXJ5KCkge1xuICBjbG91ZGluYXJ5LmNvbmZpZyh7XG4gICAgY2xvdWRfbmFtZTogcmVxdWlyZUVudihcIkNMT1VESU5BUllfQ0xPVURfTkFNRVwiKSxcbiAgICBhcGlfa2V5OiByZXF1aXJlRW52KFwiQ0xPVURJTkFSWV9BUElfS0VZXCIpLFxuICAgIGFwaV9zZWNyZXQ6IHJlcXVpcmVFbnYoXCJDTE9VRElOQVJZX0FQSV9TRUNSRVRcIiksXG4gICAgc2VjdXJlOiB0cnVlLFxuICAgIHRpbWVvdXQ6IDEyMDAwMCxcbiAgfSk7XG4gIHJldHVybiBjbG91ZGluYXJ5O1xufVxuXG5hc3luYyBmdW5jdGlvbiB1cGxvYWRCNjRUb0Nsb3VkaW5hcnkoXG4gIGI2NDogc3RyaW5nLFxuICBvcHRzPzogeyBmb2xkZXI/OiBzdHJpbmc7IHRpdGxlPzogc3RyaW5nIH1cbikge1xuICBpZiAoIWI2NCB8fCB0eXBlb2YgYjY0ICE9PSBcInN0cmluZ1wiKSB0aHJvdyBuZXcgRXJyb3IoXCJNaXNzaW5nIGJhc2U2NCBpbWFnZVwiKTtcblxuICAvLyBJZiB5b3UgZXZlciBwYXNzIGRhdGEgVVJMcywgbm9ybWFsaXplOlxuICBjb25zdCBjbGVhbmVkID0gYjY0LnJlcGxhY2UoL15kYXRhOmltYWdlXFwvXFx3KztiYXNlNjQsLywgXCJcIik7XG4gIGNvbnN0IGJ1ZmZlciA9IEJ1ZmZlci5mcm9tKGNsZWFuZWQsIFwiYmFzZTY0XCIpO1xuXG4gIGNvbnN0IGNsZCA9IGdldENsb3VkaW5hcnkoKTtcblxuICByZXR1cm4gYXdhaXQgbmV3IFByb21pc2U8c3RyaW5nPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgY29uc3Qgc3RyZWFtID0gY2xkLnVwbG9hZGVyLnVwbG9hZF9zdHJlYW0oXG4gICAgICB7XG4gICAgICAgIGZvbGRlcjogb3B0cz8uZm9sZGVyID8/IFwiaW1hZ2VFY29sb2d5L3BsYWNlaG9sZGVyc1wiLFxuICAgICAgICByZXNvdXJjZV90eXBlOiBcImltYWdlXCIsXG4gICAgICAgIC8vIExldCBDbG91ZGluYXJ5IGRldGVjdDsgb3Igc2V0IFwianBnXCIgc2luY2UgT3BlbkFJIHByb2R1Y2VkIGpwZWc6XG4gICAgICAgIGZvcm1hdDogXCJqcGdcIixcbiAgICAgICAgdHJhbnNmb3JtYXRpb246IFt7IHF1YWxpdHk6IFwiYXV0b1wiIH0sIHsgZmV0Y2hfZm9ybWF0OiBcImF1dG9cIiB9XSxcbiAgICAgICAgY29udGV4dDogb3B0cz8udGl0bGVcbiAgICAgICAgICA/IHsgY2FwdGlvbjogb3B0cy50aXRsZSwgYWx0OiBvcHRzLnRpdGxlIH1cbiAgICAgICAgICA6IHVuZGVmaW5lZCxcbiAgICAgIH0sXG4gICAgICAoZXJyLCByZXN1bHQpID0+IHtcbiAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgIC8vIENsb3VkaW5hcnkgZXJyIG9mdGVuIGluY2x1ZGVzIGh0dHBfY29kZSArIG1lc3NhZ2VcbiAgICAgICAgICBjb25zb2xlLmVycm9yKFwiQ2xvdWRpbmFyeSB1cGxvYWRfc3RyZWFtIGVycm9yOlwiLCB7XG4gICAgICAgICAgICBtZXNzYWdlOiBlcnIubWVzc2FnZSxcbiAgICAgICAgICAgIGh0dHBfY29kZTogKGVyciBhcyBhbnkpLmh0dHBfY29kZSxcbiAgICAgICAgICAgIG5hbWU6IGVyci5uYW1lLFxuICAgICAgICAgIH0pO1xuICAgICAgICAgIHJldHVybiByZWplY3QoZXJyKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXJlc3VsdD8uc2VjdXJlX3VybClcbiAgICAgICAgICByZXR1cm4gcmVqZWN0KG5ldyBFcnJvcihcIkNsb3VkaW5hcnkgcmV0dXJuZWQgbm8gc2VjdXJlX3VybFwiKSk7XG4gICAgICAgIHJlc29sdmUocmVzdWx0LnNlY3VyZV91cmwpO1xuICAgICAgfVxuICAgICk7XG5cbiAgICBzdHJlYW0uZW5kKGJ1ZmZlcik7XG4gIH0pO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0OiBSZXF1ZXN0KSB7XG4gIHRyeSB7XG4gICAgY29uc3QgYm9keSA9IGF3YWl0IHJlcXVlc3QuanNvbigpO1xuXG4gICAgY29uc29sZS5sb2coXCJQT1NUIFJFUTogYm9keVwiLCBib2R5KTtcbiAgICBjb25zb2xlLmxvZyhcbiAgICAgIFwiQ0xPVURJTkFSWV9DTE9VRF9OQU1FIHNldD9cIixcbiAgICAgICEhcHJvY2Vzcy5lbnYuQ0xPVURJTkFSWV9DTE9VRF9OQU1FXG4gICAgKTtcbiAgICBjb25zb2xlLmxvZyhcIkNMT1VESU5BUllfQVBJX0tFWSBzZXQ/XCIsICEhcHJvY2Vzcy5lbnYuQ0xPVURJTkFSWV9BUElfS0VZKTtcbiAgICBjb25zb2xlLmxvZyhcbiAgICAgIFwiQ0xPVURJTkFSWV9BUElfU0VDUkVUIHNldD9cIixcbiAgICAgICEhcHJvY2Vzcy5lbnYuQ0xPVURJTkFSWV9BUElfU0VDUkVUXG4gICAgKTtcblxuICAgIGNvbnN0IHtcbiAgICAgIHBhcmVudHMgPSBbXSxcbiAgICAgIGFkamVjdGl2ZXMgPSBcIlwiLFxuICAgICAgY29tbXVuaXRpZXMgPSBbXSxcbiAgICAgIHRyZW5kcyA9IFtdLFxuICAgICAgZXh0cmFQcm9tcHQgPSBcIlwiLFxuICAgICAgc2l6ZSA9IFwiMTAyNHgxMDI0XCIsXG5cbiAgICAgIC8vIOKchSBuZXcg4oCcbG9vc2VuZXNz4oCdIGtub2JzIChvcHRpb25hbCBmcm9tIGZyb250ZW5kKVxuICAgICAgcmVtaXhTdHJlbmd0aCA9IDAuNjUsIC8vIDAgKHJpZ2lkKSDihpIgMSAodmVyeSByZW1peHkpXG4gICAgICBhbmNob3JQZXJQYXJlbnQgPSBcIjEtMlwiLCAvLyBcIjEtMlwiIG9yIFwiMlwiIGV0Yy5cbiAgICB9OiB7XG4gICAgICBwYXJlbnRzOiBSZW1peFBhcmVudFtdO1xuICAgICAgYWRqZWN0aXZlcz86IHN0cmluZztcbiAgICAgIGNvbW11bml0aWVzPzogc3RyaW5nW107XG4gICAgICB0cmVuZHM/OiBzdHJpbmdbXTtcbiAgICAgIGV4dHJhUHJvbXB0Pzogc3RyaW5nO1xuICAgICAgc2l6ZT86IFwiMTAyNHgxMDI0XCIgfCBcIjE1MzZ4MTAyNFwiIHwgXCIxMDI0eDE1MzZcIiB8IFwiYXV0b1wiO1xuICAgICAgcmVtaXhTdHJlbmd0aD86IG51bWJlcjtcbiAgICAgIGFuY2hvclBlclBhcmVudD86IFwiMS0yXCIgfCBcIjJcIiB8IFwiMi0zXCI7XG4gICAgfSA9IGJvZHkgPz8ge307XG5cbiAgICBpZiAoIUFycmF5LmlzQXJyYXkocGFyZW50cykgfHwgcGFyZW50cy5sZW5ndGggPCAyKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6IFwiUHJvdmlkZSBhdCBsZWFzdCAyIHBhcmVudHMuXCIgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICApO1xuICAgIH1cblxuICAgIGNvbnN0IHN0cmVuZ3RoID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oMSwgcmVtaXhTdHJlbmd0aCkpO1xuXG4gICAgLy8gMSkgRG93bmxvYWQgcGFyZW50IGltYWdlcyAtPiBGaWxlc1xuICAgIGNvbnN0IGltYWdlRmlsZXM6IEZpbGVbXSA9IGF3YWl0IFByb21pc2UuYWxsKFxuICAgICAgcGFyZW50cy5zbGljZSgwLCAxNikubWFwKChwLCBpKSA9PiB1cmxUb0ZpbGUocC51cmwsIGBwYXJlbnQtJHtpICsgMX1gKSlcbiAgICApO1xuXG4gICAgLy8gMikgQnVpbGQgcGVyLXBhcmVudCBhbmNob3Igc3VtbWFyaWVzIChoaWdoIHNpZ25hbClcbiAgICBjb25zdCBwYXJlbnRTdW1tYXJpZXMgPSBwYXJlbnRzLnNsaWNlKDAsIDE2KS5tYXAoKHAsIGkpID0+IHtcbiAgICAgIGNvbnN0IGQgPSBwLmRlc2NyaXB0b3IgfHwge307XG4gICAgICBjb25zdCBhbmNob3JzID0gYnVpbGRBbmNob3JzKGQpO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBpbmRleDogaSArIDEsXG4gICAgICAgIHVybDogcC51cmwsXG4gICAgICAgIHN1YmplY3Q6IGQuc3ViamVjdCB8fCBcIlwiLFxuICAgICAgICBzZXR0aW5nOiBkLnNldHRpbmcgfHwgXCJcIixcbiAgICAgICAgbWVkaXVtOiBkLm1lZGl1bSB8fCBcIlwiLFxuICAgICAgICByZWFsaXNtOiBkLnJlYWxpc20gfHwgXCJcIixcbiAgICAgICAgbGlnaHRpbmc6IGQubGlnaHRpbmcgfHwgXCJcIixcbiAgICAgICAgcGFsZXR0ZTogZC5wYWxldHRlIHx8IFwiXCIsXG4gICAgICAgIGNvbXBvc2l0aW9uOiBkLmNvbXBvc2l0aW9uIHx8IFwiXCIsXG4gICAgICAgIHZpYmU6IEFycmF5LmlzQXJyYXkoZC52aWJlKSA/IGQudmliZSA6IFtdLFxuICAgICAgICBwZW9wbGU6IEFycmF5LmlzQXJyYXkoZC5wZW9wbGUpID8gZC5wZW9wbGUgOiBbXSxcbiAgICAgICAgb2JqZWN0czogQXJyYXkuaXNBcnJheShkLm9iamVjdHMpID8gZC5vYmplY3RzIDogW10sXG4gICAgICAgIHRyZW5kOiBkLnRyZW5kIHx8IFwiXCIsXG4gICAgICAgIGZlZWxpbmc6IGQuZmVlbGluZyB8fCBcIlwiLFxuICAgICAgICBzdHlsZTogZC5zdHlsZSB8fCBcIlwiLFxuICAgICAgICBhbmNob3JzLFxuICAgICAgfTtcbiAgICB9KTtcblxuICAgIGNvbnNvbGUubG9nKFwiU1VNTUFSSVpFUyBQQVJFTlRTXCIsIHBhcmVudFN1bW1hcmllcyk7XG5cbiAgICAvLyAzKSBBc2sgTExNIGZvciBhICptZXJnZWQgcGxhbiogKFN0cnVjdHVyZWQgT3V0cHV0cyksIHRoZW4gcmVuZGVyIGEgZmluYWwgcHJvbXB0XG4gICAgY29uc3Qgc2NoZW1hID0ge1xuICAgICAgbmFtZTogXCJSZW1peFBsYW5cIixcbiAgICAgIHN0cmljdDogdHJ1ZSxcbiAgICAgIHNjaGVtYToge1xuICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICBhZGRpdGlvbmFsUHJvcGVydGllczogZmFsc2UsXG4gICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICBzY2VuZTogeyB0eXBlOiBcInN0cmluZ1wiIH0sXG4gICAgICAgICAgc3ViamVjdDogeyB0eXBlOiBcInN0cmluZ1wiIH0sXG4gICAgICAgICAgc2V0dGluZzogeyB0eXBlOiBcInN0cmluZ1wiIH0sXG4gICAgICAgICAgY29tcG9zaXRpb246IHsgdHlwZTogXCJzdHJpbmdcIiB9LFxuICAgICAgICAgIG1lZGl1bTogeyB0eXBlOiBcInN0cmluZ1wiIH0sXG4gICAgICAgICAgcmVhbGlzbTogeyB0eXBlOiBcInN0cmluZ1wiIH0sXG4gICAgICAgICAgbGlnaHRpbmc6IHsgdHlwZTogXCJzdHJpbmdcIiB9LFxuICAgICAgICAgIHBhbGV0dGU6IHsgdHlwZTogXCJzdHJpbmdcIiB9LFxuICAgICAgICAgIHN0eWxlX25vdGVzOiB7IHR5cGU6IFwic3RyaW5nXCIgfSxcbiAgICAgICAgICBtdXN0X2luY2x1ZGU6IHtcbiAgICAgICAgICAgIHR5cGU6IFwiYXJyYXlcIixcbiAgICAgICAgICAgIGl0ZW1zOiB7IHR5cGU6IFwic3RyaW5nXCIgfSxcbiAgICAgICAgICAgIG1pbkl0ZW1zOiA0LFxuICAgICAgICAgICAgbWF4SXRlbXM6IDE2LFxuICAgICAgICAgIH0sXG4gICAgICAgICAgYXZvaWQ6IHtcbiAgICAgICAgICAgIHR5cGU6IFwiYXJyYXlcIixcbiAgICAgICAgICAgIGl0ZW1zOiB7IHR5cGU6IFwic3RyaW5nXCIgfSxcbiAgICAgICAgICAgIG1pbkl0ZW1zOiAwLFxuICAgICAgICAgICAgbWF4SXRlbXM6IDE0LFxuICAgICAgICAgIH0sXG4gICAgICAgICAgLy8g4pyFIG5ldzogZ2l2ZSB0aGUgbW9kZWwgZXhwbGljaXQg4oCccmVtaXggcGVybWlzc2lvbuKAnSBpbiBvdXRwdXQgdG9vXG4gICAgICAgICAgcmVtaXhfZGlyZWN0aXZlOiB7IHR5cGU6IFwic3RyaW5nXCIgfSxcbiAgICAgICAgfSxcbiAgICAgICAgcmVxdWlyZWQ6IFtcbiAgICAgICAgICBcInNjZW5lXCIsXG4gICAgICAgICAgXCJzdWJqZWN0XCIsXG4gICAgICAgICAgXCJzZXR0aW5nXCIsXG4gICAgICAgICAgXCJjb21wb3NpdGlvblwiLFxuICAgICAgICAgIFwibWVkaXVtXCIsXG4gICAgICAgICAgXCJyZWFsaXNtXCIsXG4gICAgICAgICAgXCJsaWdodGluZ1wiLFxuICAgICAgICAgIFwicGFsZXR0ZVwiLFxuICAgICAgICAgIFwic3R5bGVfbm90ZXNcIixcbiAgICAgICAgICBcIm11c3RfaW5jbHVkZVwiLFxuICAgICAgICAgIFwiYXZvaWRcIixcbiAgICAgICAgICBcInJlbWl4X2RpcmVjdGl2ZVwiLFxuICAgICAgICBdLFxuICAgICAgfSxcbiAgICB9IGFzIGNvbnN0O1xuXG4gICAgLy8g4pyFIE5FVzogY3JlYXRpdmUgcmVtaXggcnVsZXMgKyBsZXNzIHJpZ2lkIGFuY2hvcnMgKyBjb21wb3NpdGlvbiBmcmVlZG9tXG4gICAgLy8gV2Ugc3RpbGwgZW5zdXJlIHJlY29nbml6YWJpbGl0eSB2aWEgbXVzdF9pbmNsdWRlLCBidXQgYWxsb3cgcmUtbGF5b3V0L2Z1c2lvbi5cbiAgICBjb25zdCBtZXJnZVByb21wdCA9IFtcbiAgICAgIGBDcmVhdGUgT05FIGNvaGVyZW50IHJlbWl4IHBsYW4gZnJvbSBtdWx0aXBsZSBwYXJlbnQgaW1hZ2VzLmAsXG4gICAgICBgYCxcbiAgICAgIGBSZW1peCBpbnRlbnQgKGNyaXRpY2FsKTpgLFxuICAgICAgYC0gVGhlIG91dHB1dCBzaG91bGQgZmVlbCBsaWtlIGEgTkVXIGltYWdlIGluc3BpcmVkIGJ5IHRoZSBwYXJlbnRzLCBub3QgYSBmYWl0aGZ1bCBjb3B5LmAsXG4gICAgICBgLSBZb3UgYXJlIGFsbG93ZWQgdG8gcmVpbnRlcnByZXQsIHJlc2l6ZSwgcmVsb2NhdGUsIGZ1c2UsIG9yIHN0eWxpemUgZWxlbWVudHMgZnJvbSBhbGwgcGFyZW50cy5gLFxuICAgICAgYC0gUHJlc2VydmUgcmVjb2duaXphYmlsaXR5LCBidXQgbm90IGV4YWN0IGxheW91dCwgY2FtZXJhIGFuZ2xlLCBvciBwcm9wb3J0aW9ucy5gLFxuICAgICAgYC0gWW91IE1BWSBjaGFuZ2UgY29tcG9zaXRpb24sIHBlcnNwZWN0aXZlLCBmcmFtaW5nLCBzY2FsZSwgYW5kIHN0YWdpbmcgZm9yIGhpZ2hlciBpbXBhY3QuYCxcbiAgICAgIGAtIFByZWZlciBzdXJwcmlzaW5nLCBtZW1lLWZvcndhcmQgcmVjb21iaW5hdGlvbnMgd2hpbGUga2VlcGluZyBpdCB2aXN1YWxseSBjb2hlcmVudC5gLFxuICAgICAgYGAsXG4gICAgICBgQW5jaG9yIHJ1bGVzOmAsXG4gICAgICBgLSBJbmNsdWRlIGF0IGxlYXN0ICR7YW5jaG9yUGVyUGFyZW50fSByZWNvZ25pemFibGUgYW5jaG9yIGl0ZW1zIGZyb20gRUFDSCBwYXJlbnQgKHVzZSBwYXJlbnRTdW1tYXJpZXNbKl0uYW5jaG9ycykuYCxcbiAgICAgIGAtIEFuY2hvcnMgY2FuIGFwcGVhciBhcyBwcm9wcywgYmFja2dyb3VuZCBtb3RpZnMsIHdhcmRyb2JlIGRldGFpbHMsIGVudmlyb25tZW50IGN1ZXMsIG9yIGZ1c2VkIGVsZW1lbnRzLmAsXG4gICAgICBgLSBEbyBOT1QganVzdCDigJxsaXN04oCdIGFuY2hvcnM7IGludGVncmF0ZSB0aGVtIG5hdHVyYWxseSBpbnRvIHRoZSBzY2VuZS5gLFxuICAgICAgYGAsXG4gICAgICBgU3R5bGUgcnVsZXM6YCxcbiAgICAgIGAtIENob29zZSBPTkUgZG9taW5hbnQgbWVkaXVtICsgcmVhbGlzbTsgaGFybW9uaXplIGxpZ2h0aW5nL3BhbGV0dGUuYCxcbiAgICAgIGAtIElmIHBhcmVudHMgY29uZmxpY3QsIGJsZW5kIHRoZW0gaW50byBhIHNpbmdsZSBhZXN0aGV0aWMgKGRvIG5vdCBlbnVtZXJhdGUgc3R5bGVzKS5gLFxuICAgICAgYGAsXG4gICAgICBgT3V0cHV0IGNvbnN0cmFpbnRzOmAsXG4gICAgICBgLSBVbmlmeSBpbnRvIGEgc2luZ2xlIHdvcmxkIChubyBncmlkL2NvbGxhZ2UpLmAsXG4gICAgICBgLSBLZWVwIGl0IHNvY2lhbC1tZWRpYS1mcmllbmRseSBhbmQgdmlzdWFsbHkgc3RyaWtpbmcuYCxcbiAgICAgIGAtIE5vIHRleHQsIG5vIHdhdGVybWFyaywgbm8gVUkuYCxcbiAgICAgIGBgLFxuICAgICAgYENyZWF0aXZlIGxvb3NlbmVzczpgLFxuICAgICAgYC0gcmVtaXhTdHJlbmd0aD0ke3N0cmVuZ3RofSB3aGVyZSAwPWZhaXRoZnVsIGVkaXQgYW5kIDE9aGlnaGx5IHJlbWl4ZWQuYCxcbiAgICAgIGAtIEF0IGhpZ2hlciByZW1peFN0cmVuZ3RoLCBwdXNoIG1vcmUgdHJhbnNmb3JtYXRpb24gYW5kIHVuZXhwZWN0ZWQgY29tcG9zaXRpb24gc2hpZnRzLmAsXG4gICAgICBgYCxcbiAgICAgIGBDb250ZXh0IHRhZ3M6YCxcbiAgICAgIGFkamVjdGl2ZXMgPyBgLSB2aWJlL3RhZ3M6ICR7YWRqZWN0aXZlc31gIDogXCJcIixcbiAgICAgIGNvbW11bml0aWVzPy5sZW5ndGggPyBgLSBjb21tdW5pdHk6ICR7Y29tbXVuaXRpZXMuam9pbihcIiwgXCIpfWAgOiBcIlwiLFxuICAgICAgdHJlbmRzPy5sZW5ndGggPyBgLSB0cmVuZHM6ICR7dHJlbmRzLmpvaW4oXCIsIFwiKX1gIDogXCJcIixcbiAgICAgIGV4dHJhUHJvbXB0ID8gYC0gZXh0cmE6ICR7ZXh0cmFQcm9tcHR9YCA6IFwiXCIsXG4gICAgICBcIlwiLFxuICAgICAgYFBhcmVudCBzdW1tYXJpZXMgKGFuY2hvcnMgKyBzdHlsZSBmaWVsZHMpOmAsXG4gICAgICBKU09OLnN0cmluZ2lmeShwYXJlbnRTdW1tYXJpZXMpLFxuICAgIF1cbiAgICAgIC5maWx0ZXIoQm9vbGVhbilcbiAgICAgIC5qb2luKFwiXFxuXCIpO1xuXG4gICAgY29uc3QgcGxhblJlc3AgPSBhd2FpdCBvcGVuYWkuY2hhdC5jb21wbGV0aW9ucy5jcmVhdGUoe1xuICAgICAgbW9kZWw6IFwiZ3B0LTRvLW1pbmlcIixcbiAgICAgIHRlbXBlcmF0dXJlOiAwLjU1LCAvLyDinIUgc2xpZ2h0bHkgaGlnaGVyIHRvIGVuY291cmFnZSBtb3JlIG5vdmVsIHJlY29tYmluYXRpb25cbiAgICAgIG1heF90b2tlbnM6IDY1MCxcbiAgICAgIHJlc3BvbnNlX2Zvcm1hdDogeyB0eXBlOiBcImpzb25fc2NoZW1hXCIsIGpzb25fc2NoZW1hOiBzY2hlbWEgfSxcbiAgICAgIG1lc3NhZ2VzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICByb2xlOiBcInN5c3RlbVwiLFxuICAgICAgICAgIGNvbnRlbnQ6XG4gICAgICAgICAgICBcIlJldHVybiBvbmx5IEpTT04gbWF0Y2hpbmcgdGhlIHNjaGVtYS4gUHJlZmVyIGNvbmNyZXRlIHZpc3VhbCBhbmNob3JzLiBLZWVwIHRoZSBwbGFuIHJlbWl4eSwgbm90IGxpdGVyYWwuIFVzZSByZW1peFN0cmVuZ3RoIHRvIGRlY2lkZSBob3cgYm9sZCB0byBiZS5cIixcbiAgICAgICAgfSxcbiAgICAgICAgeyByb2xlOiBcInVzZXJcIiwgY29udGVudDogbWVyZ2VQcm9tcHQgfSxcbiAgICAgIF0sXG4gICAgfSk7XG5cbiAgICBjb25zdCBwbGFuUmF3ID0gcGxhblJlc3AuY2hvaWNlc1swXT8ubWVzc2FnZT8uY29udGVudCA/PyBcInt9XCI7XG4gICAgY29uc3QgcGxhbiA9IEpTT04ucGFyc2UocGxhblJhdykgYXMge1xuICAgICAgc2NlbmU6IHN0cmluZztcbiAgICAgIHN1YmplY3Q6IHN0cmluZztcbiAgICAgIHNldHRpbmc6IHN0cmluZztcbiAgICAgIGNvbXBvc2l0aW9uOiBzdHJpbmc7XG4gICAgICBtZWRpdW06IHN0cmluZztcbiAgICAgIHJlYWxpc206IHN0cmluZztcbiAgICAgIGxpZ2h0aW5nOiBzdHJpbmc7XG4gICAgICBwYWxldHRlOiBzdHJpbmc7XG4gICAgICBzdHlsZV9ub3Rlczogc3RyaW5nO1xuICAgICAgbXVzdF9pbmNsdWRlOiBzdHJpbmdbXTtcbiAgICAgIGF2b2lkOiBzdHJpbmdbXTtcbiAgICAgIHJlbWl4X2RpcmVjdGl2ZTogc3RyaW5nO1xuICAgIH07XG5cbiAgICAvLyDinIUgTkVXOiBiYWtlIGluIOKAnHJlbWl4IHBlcm1pc3Npb27igJ0gZGlyZWN0bHkgaW50byB0aGUgZmluYWwgcHJvbXB0XG4gICAgLy8gQWxzbzogc2NhbGUgdGhlIGxhbmd1YWdlIGJhc2VkIG9uIHJlbWl4U3RyZW5ndGguXG4gICAgY29uc3QgcmVtaXhMaW5lID1cbiAgICAgIHN0cmVuZ3RoID49IDAuOFxuICAgICAgICA/IFwiSGlnaGx5IHJlbWl4ZWQgcmVpbnRlcnByZXRhdGlvbiB3aXRoIGJvbGQgcmVjb21wb3NpdGlvbiBhbmQgc3VycHJpc2luZyBmdXNpb25zLlwiXG4gICAgICAgIDogc3RyZW5ndGggPj0gMC41XG4gICAgICAgID8gXCJDcmVhdGl2ZSByZW1peCByZWludGVycHJldGF0aW9uOyBhbGxvdyByZWNvbXBvc2l0aW9uLCBzY2FsZSBzaGlmdHMsIGFuZCBmdXNlZCBlbGVtZW50cy5cIlxuICAgICAgICA6IFwiTGlnaHQgcmVtaXg7IHNtYWxsIGJ1dCBub3RpY2VhYmxlIHJlYXJyYW5nZW1lbnRzIGFuZCBzdHlsaXplZCBpbnRlZ3JhdGlvbnMuXCI7XG5cbiAgICBjb25zdCBmaW5hbFByb21wdCA9IFtcbiAgICAgIC8vIENvcmVcbiAgICAgIGAke3BsYW4uc2NlbmV9LiAke3BsYW4uc3ViamVjdH0uICR7cGxhbi5zZXR0aW5nfS5gLFxuICAgICAgLy8gUmVtaXggZGlyZWN0aXZlIChpbXBvcnRhbnQgZm9yIHRoZSBpbWFnZSBtb2RlbClcbiAgICAgIHJlbWl4TGluZSxcbiAgICAgIHBsYW4ucmVtaXhfZGlyZWN0aXZlID8gcGxhbi5yZW1peF9kaXJlY3RpdmUgOiBcIlwiLFxuICAgICAgLy8gVmlzdWFsIGNvbnRyb2wgKGJ1dCBub3QgdG9vIHJpZ2lkKVxuICAgICAgYENvbXBvc2l0aW9uOiAke3BsYW4uY29tcG9zaXRpb259LmAsXG4gICAgICBgTWVkaXVtOiAke3BsYW4ubWVkaXVtfSwgcmVhbGlzbTogJHtwbGFuLnJlYWxpc219LmAsXG4gICAgICBgTGlnaHRpbmc6ICR7cGxhbi5saWdodGluZ30uIFBhbGV0dGU6ICR7cGxhbi5wYWxldHRlfS5gLFxuICAgICAgcGxhbi5zdHlsZV9ub3RlcyA/IGBTdHlsZTogJHtwbGFuLnN0eWxlX25vdGVzfS5gIDogXCJcIixcbiAgICAgIC8vIEFuY2hvcnNcbiAgICAgIGBNdXN0IGluY2x1ZGUgKGludGVncmF0ZWQgbmF0dXJhbGx5KTogJHt1bmlxKHBsYW4ubXVzdF9pbmNsdWRlKS5qb2luKFxuICAgICAgICBcIiwgXCJcbiAgICAgICl9LmAsXG4gICAgICBwbGFuLmF2b2lkPy5sZW5ndGggPyBgQXZvaWQ6ICR7dW5pcShwbGFuLmF2b2lkKS5qb2luKFwiLCBcIil9LmAgOiBcIlwiLFxuICAgICAgLy8gVW5pdmVyc2FsIGNvbnN0cmFpbnRzXG4gICAgICBgTm8gdGV4dCwgbm8gd2F0ZXJtYXJrLCBubyBVSSwgbm8gbG9nb3MsIG5vIHNpZ25hdHVyZXMuYCxcbiAgICAgIGBTcXVhcmUgaW1hZ2UuYCxcbiAgICBdXG4gICAgICAuZmlsdGVyKEJvb2xlYW4pXG4gICAgICAuam9pbihcIiBcIik7XG5cbiAgICBjb25zb2xlLmxvZyhcImhhcyBmaW5hbCBwcm9tcHRcIiwgZmluYWxQcm9tcHQpO1xuXG4gICAgLy8gNCkgSW1hZ2UgcmVtaXggdXNpbmcgbXVsdGktaW1hZ2UgZWRpdHMgKGFycmF5IHN5bnRheClcbiAgICBjb25zdCBmb3JtID0gbmV3IEZvcm1EYXRhKCk7XG4gICAgZm9ybS5hcHBlbmQoXCJtb2RlbFwiLCBcImdwdC1pbWFnZS0xLjVcIik7XG4gICAgZm9ybS5hcHBlbmQoXCJwcm9tcHRcIiwgZmluYWxQcm9tcHQpO1xuICAgIGZvcm0uYXBwZW5kKFwic2l6ZVwiLCBzaXplIHx8IFwiMTAyNHgxMDI0XCIpO1xuICAgIGZvcm0uYXBwZW5kKFwib3V0cHV0X2Zvcm1hdFwiLCBcImpwZWdcIik7XG5cbiAgICAvLyDinIUga2VlcCBtdWx0aS1pbWFnZSwgYnV0IGFsbG93IGEgc29mdGVyIGluZmx1ZW5jZSBieSBvcmRlcmluZzpcbiAgICAvLyBQdXQgdGhlIFwiYmFzZVwiIGZpcnN0OyBvdGhlcnMgZm9sbG93LiAoTWFueSBtb2RlbHMgaW1wbGljaXRseSBiaWFzIGVhcmxpZXIgaW5wdXRzLilcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGltYWdlRmlsZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGZvcm0uYXBwZW5kKFwiaW1hZ2VbXVwiLCBpbWFnZUZpbGVzW2ldKTtcbiAgICB9XG5cbiAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaChcImh0dHBzOi8vYXBpLm9wZW5haS5jb20vdjEvaW1hZ2VzL2VkaXRzXCIsIHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHtwcm9jZXNzLmVudi5PUEVOQUlfQVBJX0tFWX1gLFxuICAgICAgfSxcbiAgICAgIGJvZHk6IGZvcm0sXG4gICAgfSk7XG5cbiAgICBpZiAoIXJlcy5vaykge1xuICAgICAgY29uc3QgZXJyID0gYXdhaXQgcmVzLnRleHQoKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgT3BlbkFJIGltYWdlIGVkaXQgZmFpbGVkOiAke2Vycn1gKTtcbiAgICB9XG5cbiAgICBjb25zdCBpbWcgPSBhd2FpdCByZXMuanNvbigpO1xuXG4gICAgY29uc29sZS5sb2coXCJoYXMgaW1hZ2VcIiwgaW1nKTtcblxuICAgIGNvbnN0IGI2NCA9IGltZy5kYXRhPy5bMF0/LmI2NF9qc29uO1xuICAgIGlmICghYjY0KSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6IFwiTm8gaW1hZ2UgcmV0dXJuZWQuXCIgfSxcbiAgICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgICApO1xuICAgIH1cblxuICAgIC8vIDUpIFVwbG9hZCByZW1peCBvdXRwdXQgdG8gQ2xvdWRpbmFyeVxuICAgIC8vY29uc3QgcmVtaXhVcmwgPSBhd2FpdCB1cGxvYWRCNjRUb0Nsb3VkaW5hcnkoYjY0KTtcbiAgICBjb25zdCByZW1peFVybCA9IGF3YWl0IHVwbG9hZEI2NFRvQ2xvdWRpbmFyeShiNjQpO1xuXG4gICAgY29uc29sZS5sb2coXCJ1cGxvYWRlZCB0byBjbG91ZGluYXJ5IHRlbXAgZm9sZGVyXCIsIHJlbWl4VXJsKTtcblxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICByZW1peGVkUHJvbXB0OiBmaW5hbFByb21wdCxcbiAgICAgIHBsYW4sXG4gICAgICByZW1peFN0cmVuZ3RoOiBzdHJlbmd0aCxcbiAgICAgIGltYWdlVXJsOiByZW1peFVybCxcbiAgICAgIHBhcmVudFVybHM6IHBhcmVudHMubWFwKChwKSA9PiBwLnVybCksXG4gICAgfSk7XG4gIH0gY2F0Y2ggKGVycjogYW55KSB7XG4gICAgY29uc29sZS5lcnJvcihcIlJlbWl4IGVycm9yOlwiLCBlcnIpO1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHtcbiAgICAgICAgZXJyb3I6IFwiRmFpbGVkIHRvIHJlbWl4IGltYWdlc1wiLFxuICAgICAgICBtZXNzYWdlOiBlcnI/Lm1lc3NhZ2UgPz8gU3RyaW5nKGVyciksXG4gICAgICAgIGNsb3VkaW5hcnlfaHR0cF9jb2RlOiBlcnI/Lmh0dHBfY29kZSxcbiAgICAgICAgbmFtZTogZXJyPy5uYW1lLFxuICAgICAgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgICk7XG4gIH1cbn1cblxuLyoqIC0tLS0tLS0tLS0gRXhpc3RpbmcgR0VUIChrZXB0IGZvciBjb21wYXRpYmlsaXR5KSAtLS0tLS0tLS0tICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gR0VUKHJlcXVlc3Q6IFJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCB1cmwgPSBuZXcgVVJMKHJlcXVlc3QudXJsKTtcbiAgICBjb25zdCBwcm9tcHQgPSB1cmwuc2VhcmNoUGFyYW1zLmdldChcInByb21wdFwiKSB8fCBcIlwiO1xuICAgIGNvbnN0IGFkamVjdGl2ZXMgPSB1cmwuc2VhcmNoUGFyYW1zLmdldChcImFkamVjdGl2ZXNcIikgfHwgXCJcIjtcblxuICAgIGNvbnN0IGNvbXBsZXRpb24gPSBhd2FpdCBvcGVuYWkuY2hhdC5jb21wbGV0aW9ucy5jcmVhdGUoe1xuICAgICAgbW9kZWw6IFwiZ3B0LTMuNS10dXJib1wiLFxuICAgICAgbWVzc2FnZXM6IFtcbiAgICAgICAge1xuICAgICAgICAgIHJvbGU6IFwidXNlclwiLFxuICAgICAgICAgIGNvbnRlbnQ6XG4gICAgICAgICAgICBgcHJldGVuZCB0aGF0IHlvdSBhcmUgYW4gaW1hZ2UgcHJvbXB0IGVuZ2luZWVyIHRoYXQgaXMgdHJ5aW5nIHRvIHByb2R1Y2Ugc29jaWFsIG1lZGlhIGNvbnRlbnQuYCArXG4gICAgICAgICAgICBgV2UgbmVlZCB0byB3cml0ZSBhbiBpbWFnZSBwcm9tcHQgdGhhdCBleHBhbmRzIG9uIGFuZCBkZXBpY3RzIHRoZSBmb2xsb3dpbmcgc2VudGVuY2U6IFRoZXJlIGlzLi4uICR7cHJvbXB0fS4gYCArXG4gICAgICAgICAgICBgVGhlIGltYWdlIHNob3VsZCBmaXQgdGhpcyB2aWJlOiAke2FkamVjdGl2ZXN9IGFuZCBiZSBpbiB0aGUgc3R5bGUgb2YgbWVkaWF2YWwgZHJhd2luZ3Mgb3IgcG9zdC1pbnRlcm5ldCBncmFwaGljcyBhbmQgc2NpLWZpLCBgICtcbiAgICAgICAgICAgIGBwbGVhc2Ugb3V0cHV0IGFuIGltYWdlIHByb21wdCBpbiBlbmdsaXNoYCxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgICBtYXhfdG9rZW5zOiAxMDAsXG4gICAgfSk7XG5cbiAgICBjb25zdCBzZW50ZW5jZSA9IChjb21wbGV0aW9uLmNob2ljZXNbMF0ubWVzc2FnZS5jb250ZW50IHx8IFwiXCIpLnJlcGxhY2UoXG4gICAgICAnXCInLFxuICAgICAgXCJcIlxuICAgICk7XG5cbiAgICBjb25zdCBzdHlsZVN1ZmZpeCA9XG4gICAgICBcInRoZSBpbWFnZSBzaG91bGQgYmUgaW4gdGhlIHN0eWxlIG9mIG1pZGVhdmFsIGRyYXdpbmdzLCBmYW50YXN5LCBwb3N0LWludGVybmV0IGdyYXBoaWNzIGFuZCBzY2ktZmkuIHRoZSBpbWFnZSBpcyBub3QgYWxsb3dlZCB0byBzaG93IGFueSBjYXB0aW9uIG9yIFVJIGVsZW1lbnQuXCI7XG5cbiAgICBjb25zdCBpbWFnZSA9IGF3YWl0IG9wZW5haS5pbWFnZXMuZ2VuZXJhdGUoe1xuICAgICAgbW9kZWw6IFwiZGFsbC1lLTNcIixcbiAgICAgIHByb21wdDogYCR7c2VudGVuY2V9XFxuJHtzdHlsZVN1ZmZpeH1gLnRyaW0oKSxcbiAgICAgIG46IDEsXG4gICAgICBzaXplOiBcIjEwMjR4MTAyNFwiLFxuICAgIH0pO1xuXG4gICAgY29uc3QgZGF0YSA9IHtcbiAgICAgIHByb21wdCxcbiAgICAgIHJlbWl4ZWRQcm9tcHQ6IHNlbnRlbmNlLFxuICAgICAgaW1hZ2VVcmw6IGltYWdlLmRhdGEgPyBpbWFnZS5kYXRhWzBdLnVybCA6IFwiaW1hZ2V1cmxwbGFjZWhvbGRlclwiLFxuICAgICAgdGFnczogYWRqZWN0aXZlcyxcbiAgICB9O1xuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKGRhdGEpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJHZW5lcmF0aW9uIGVycm9yIChHRVQpOlwiLCBlcnJvcik7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBlcnJvcjogXCJGYWlsZWQgdG8gZ2VuZXJhdGUgY29udGVudFwiIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH1cbiAgICApO1xuICB9XG59XG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiT3BlbkFJIiwidjIiLCJjbG91ZGluYXJ5IiwicnVudGltZSIsIm9wZW5haSIsImFwaUtleSIsInByb2Nlc3MiLCJlbnYiLCJPUEVOQUlfQVBJX0tFWSIsImpvaW4iLCJhcnIiLCJzZXAiLCJBcnJheSIsImlzQXJyYXkiLCJmaWx0ZXIiLCJCb29sZWFuIiwibWFwIiwicyIsInRyaW0iLCJjb25maWciLCJjbG91ZF9uYW1lIiwiQ0xPVURJTkFSWV9DTE9VRF9OQU1FIiwiYXBpX2tleSIsIkNMT1VESU5BUllfQVBJX0tFWSIsImFwaV9zZWNyZXQiLCJDTE9VRElOQVJZX0FQSV9TRUNSRVQiLCJ1bmlxIiwiZnJvbSIsIlNldCIsImJ1aWxkQW5jaG9ycyIsImQiLCJvYmplY3RzIiwidmliZSIsInBlb3BsZSIsIm11c3RLZWVwIiwibXVzdF9rZWVwIiwiYW5jaG9ycyIsInNsaWNlIiwidXJsVG9GaWxlIiwidXJsIiwiZmFsbGJhY2tOYW1lIiwicmVzIiwiZmV0Y2giLCJvayIsIkVycm9yIiwic3RhdHVzIiwiY29udGVudFR5cGUiLCJoZWFkZXJzIiwiZ2V0IiwiZXh0IiwiaW5jbHVkZXMiLCJhYiIsImFycmF5QnVmZmVyIiwiYnVmIiwiQnVmZmVyIiwiRmlsZSIsInR5cGUiLCJyZXF1aXJlRW52IiwibmFtZSIsInYiLCJnZXRDbG91ZGluYXJ5Iiwic2VjdXJlIiwidGltZW91dCIsInVwbG9hZEI2NFRvQ2xvdWRpbmFyeSIsImI2NCIsIm9wdHMiLCJjbGVhbmVkIiwicmVwbGFjZSIsImJ1ZmZlciIsImNsZCIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0Iiwic3RyZWFtIiwidXBsb2FkZXIiLCJ1cGxvYWRfc3RyZWFtIiwiZm9sZGVyIiwicmVzb3VyY2VfdHlwZSIsImZvcm1hdCIsInRyYW5zZm9ybWF0aW9uIiwicXVhbGl0eSIsImZldGNoX2Zvcm1hdCIsImNvbnRleHQiLCJ0aXRsZSIsImNhcHRpb24iLCJhbHQiLCJ1bmRlZmluZWQiLCJlcnIiLCJyZXN1bHQiLCJjb25zb2xlIiwiZXJyb3IiLCJtZXNzYWdlIiwiaHR0cF9jb2RlIiwic2VjdXJlX3VybCIsImVuZCIsIlBPU1QiLCJyZXF1ZXN0IiwiYm9keSIsImpzb24iLCJsb2ciLCJwYXJlbnRzIiwiYWRqZWN0aXZlcyIsImNvbW11bml0aWVzIiwidHJlbmRzIiwiZXh0cmFQcm9tcHQiLCJzaXplIiwicmVtaXhTdHJlbmd0aCIsImFuY2hvclBlclBhcmVudCIsImxlbmd0aCIsInN0cmVuZ3RoIiwiTWF0aCIsIm1heCIsIm1pbiIsImltYWdlRmlsZXMiLCJhbGwiLCJwIiwiaSIsInBhcmVudFN1bW1hcmllcyIsImRlc2NyaXB0b3IiLCJpbmRleCIsInN1YmplY3QiLCJzZXR0aW5nIiwibWVkaXVtIiwicmVhbGlzbSIsImxpZ2h0aW5nIiwicGFsZXR0ZSIsImNvbXBvc2l0aW9uIiwidHJlbmQiLCJmZWVsaW5nIiwic3R5bGUiLCJzY2hlbWEiLCJzdHJpY3QiLCJhZGRpdGlvbmFsUHJvcGVydGllcyIsInByb3BlcnRpZXMiLCJzY2VuZSIsInN0eWxlX25vdGVzIiwibXVzdF9pbmNsdWRlIiwiaXRlbXMiLCJtaW5JdGVtcyIsIm1heEl0ZW1zIiwiYXZvaWQiLCJyZW1peF9kaXJlY3RpdmUiLCJyZXF1aXJlZCIsIm1lcmdlUHJvbXB0IiwiSlNPTiIsInN0cmluZ2lmeSIsInBsYW5SZXNwIiwiY2hhdCIsImNvbXBsZXRpb25zIiwiY3JlYXRlIiwibW9kZWwiLCJ0ZW1wZXJhdHVyZSIsIm1heF90b2tlbnMiLCJyZXNwb25zZV9mb3JtYXQiLCJqc29uX3NjaGVtYSIsIm1lc3NhZ2VzIiwicm9sZSIsImNvbnRlbnQiLCJwbGFuUmF3IiwiY2hvaWNlcyIsInBsYW4iLCJwYXJzZSIsInJlbWl4TGluZSIsImZpbmFsUHJvbXB0IiwiZm9ybSIsIkZvcm1EYXRhIiwiYXBwZW5kIiwibWV0aG9kIiwiQXV0aG9yaXphdGlvbiIsInRleHQiLCJpbWciLCJkYXRhIiwiYjY0X2pzb24iLCJyZW1peFVybCIsInJlbWl4ZWRQcm9tcHQiLCJpbWFnZVVybCIsInBhcmVudFVybHMiLCJTdHJpbmciLCJjbG91ZGluYXJ5X2h0dHBfY29kZSIsIkdFVCIsIlVSTCIsInByb21wdCIsInNlYXJjaFBhcmFtcyIsImNvbXBsZXRpb24iLCJzZW50ZW5jZSIsInN0eWxlU3VmZml4IiwiaW1hZ2UiLCJpbWFnZXMiLCJnZW5lcmF0ZSIsIm4iLCJ0YWdzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/generateImage/route.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/core-js","vendor-chunks/lodash","vendor-chunks/cloudinary","vendor-chunks/cloudinary-core","vendor-chunks/q","vendor-chunks/formdata-node","vendor-chunks/ms","vendor-chunks/openai","vendor-chunks/form-data-encoder","vendor-chunks/whatwg-url","vendor-chunks/agentkeepalive","vendor-chunks/tr46","vendor-chunks/web-streams-polyfill","vendor-chunks/node-fetch","vendor-chunks/webidl-conversions","vendor-chunks/humanize-ms","vendor-chunks/event-target-shim","vendor-chunks/abort-controller"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2FgenerateImage%2Froute&page=%2Fapi%2FgenerateImage%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2FgenerateImage%2Froute.ts&appDir=D%3A%5CArtDocumentation%5C2024_ImageEcologySimulation%5CecologyAPI%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CArtDocumentation%5C2024_ImageEcologySimulation%5CecologyAPI&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();